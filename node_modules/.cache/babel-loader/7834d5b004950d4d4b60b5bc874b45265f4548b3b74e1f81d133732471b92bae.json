{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TTC\\\\OneDrive\\\\Documents\\\\GITHUB\\\\fe-readhub\\\\src\\\\pages\\\\read_book\\\\views\\\\ReadBookScreen.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { ReactReaderStyle } from 'react-reader';\nimport ePub from 'epubjs';\nimport ReaderHeader from './ReaderHeader';\nimport ReaderContent from './ReaderContent';\nimport NotePopover from './NotePopover';\nimport NotesDrawer from './NotesDrawer';\nimport SettingsDrawer from './SettingsDrawer';\nimport { Button, Select, MenuItem, TextField, DialogActions, Dialog, DialogTitle, DialogContent } from '@mui/material';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst colors = ['#FFB3BA', '#FFDFBA', '#FFFFBA', '#BAFFC9', '#BAE1FF'];\nconst themes = ['#FFFFFF', '#F5F5F5', '#121212'];\nconst fontFamilies = ['Arial', 'Times New Roman', 'Georgia', 'Verdana', 'Roboto'];\nconst defaultSettings = {\n  theme: themes[0],\n  pageView: 'double',\n  fontFamily: fontFamilies[0],\n  fontSize: 100,\n  fontWeight: 400,\n  lineHeight: 1.5,\n  zoom: 100\n};\nfunction ReadBookScreen() {\n  _s();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loca, setLocation] = useState(location || '');\n  const {\n    bookId,\n    bookTitle\n  } = location.state || {};\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [epubUrl, setEpubUrl] = useState(null);\n  const [selections, setSelections] = useState([]);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const [rendition, setRendition] = useState(null);\n  const [highlightColor, setHighlightColor] = useState(colors[0]);\n  const [comment, setComment] = useState('');\n  const [popoverAnchor, setPopoverAnchor] = useState(null);\n  const [selectedText, setSelectedText] = useState('');\n  const [selectedCfiRange, setSelectedCfiRange] = useState('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filter, setFilter] = useState('all');\n  const [editingNote, setEditingNote] = useState(null);\n  const [settingsDrawerOpen, setSettingsDrawerOpen] = useState(false);\n  const [settings, setSettings] = useState(defaultSettings);\n  const [user, setUser] = useState(null);\n  const [isNote, setIsNote] = useState(false);\n  const [hasBookmark, setHasBookmark] = useState(false);\n  const [currentLocation, setCurrentLocation] = useState(null);\n  const [readStartTime, setReadStartTime] = useState(null);\n  const [bookmarkId, setBookmarkId] = useState(null);\n  const [totalTimeSpent, setTotalTimeSpent] = useState(0);\n  const [lastReadingUpdate, setLastReadingUpdate] = useState(null);\n  const [isActive, setIsActive] = useState(true);\n  const startReadingSession = () => {\n    setReadStartTime(Date.now());\n  };\n  const updateReadingHistory = async () => {\n    const currentTime = Date.now();\n    const timeSpent = Math.floor((currentTime - lastReadingUpdate) / 1000); // Convert to seconds\n\n    // if (timeSpent < 1) return\n\n    try {\n      await axios.post('http://localhost:8080/api/v1/reading-history', {\n        userId: user.userId,\n        bookId: bookId,\n        timeSpent: timeSpent\n      }, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setLastReadingUpdate(currentTime);\n    } catch (error) {\n      console.error('Error updating reading history:', error);\n    }\n  };\n  const saveBookmark = async location => {\n    if (!user || !bookId) return;\n    try {\n      console.log('location', loca);\n      await axios.post('http://localhost:8080/api/v1/bookmark', {\n        userId: user.userId,\n        bookId: bookId,\n        location: loca\n      }, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setHasBookmark(true);\n      toast.success('Đã lưu đánh dấu trang');\n    } catch (error) {\n      console.error('Error saving bookmark:', error);\n      toast.error('Có lỗi xảy ra khi lưu đánh dấu trang', 'error');\n    }\n  };\n  const getUser = async () => {\n    if (!localStorage.getItem('token')) return;\n    try {\n      const response = await axios.get('http://localhost:8080/api/v1/user/profile', {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setUser(response.data);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  const getNotes = async () => {\n    if (!(user !== null && user !== void 0 && user.userId) || !bookId || !rendition) return;\n    try {\n      const response = await axios.get(`http://localhost:8080/api/v1/note/user/${user.userId}/book/${bookId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n\n      // Extract the data array from the response\n      const notesData = Array.isArray(response.data.data) ? response.data.data : [];\n      setSelections(notesData);\n      if (rendition) {\n        notesData.forEach(note => {\n          rendition.annotations.add('highlight', note.cfiRange, {}, null, 'hl', {\n            fill: note.color,\n            'fill-opacity': '0.3',\n            'mix-blend-mode': 'multiply'\n          });\n        });\n      }\n    } catch (error) {\n      console.error('Error fetching notes:', error);\n      setSelections([]); // Set to empty array in case of error\n    }\n  };\n  const handleEditNote = note => {\n    setEditingNote(note);\n    console.log('note', note);\n  };\n  const handleSaveEdit = async () => {\n    try {\n      await axios.put(`http://localhost:8080/api/v1/note`, editingNote, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      if (editingNote) {\n        setSelections(selections.map(s => s.cfiRange === editingNote.cfiRange ? editingNote : s));\n        setEditingNote(null);\n      }\n      setIsNote(!isNote);\n    } catch (error) {\n      console.error('Error updating note:', error);\n    }\n  };\n  const getBookmark = async () => {\n    if (!user || !bookId) return;\n    try {\n      const response = await axios.get(`http://localhost:8080/api/v1/bookmark/user/${user.userId}/book/${bookId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      if (response.data) {\n        console.log('bookmark', response.data);\n        setHasBookmark(true);\n        setBookmarkId(response.data.data.bookmarkId);\n        console.log('bookmarkId', bookmarkId);\n        setLocation(response.data.data.location);\n      }\n    } catch (error) {\n      console.error('Error fetching bookmark:', error);\n    }\n  };\n  const handleToggleBookmark = async () => {\n    if (!user || !bookId) return;\n    if (hasBookmark && bookmarkId) {\n      try {\n        await axios.put('http://localhost:8080/api/v1/bookmark', {\n          bookmarkId: bookmarkId,\n          userId: user.userId,\n          bookId: bookId,\n          location: loca\n        }, {\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        toast.success('Đã đánh dấu trang');\n      } catch (error) {\n        toast.error('Có lỗi xảy ra khi đánh dấu trang', 'error');\n      }\n    } else {\n      await saveBookmark(currentLocation);\n    }\n  };\n  const handleError = error => {\n    console.error('Error in ReactReader:', error);\n    setError('An error occurred while loading the book. Please try again later.');\n    setLoading(false);\n  };\n  const handleToggleDrawer = () => {\n    setDrawerOpen(!drawerOpen);\n  };\n  const handleSettingsDrawerToggle = () => {\n    setSettingsDrawerOpen(!settingsDrawerOpen);\n  };\n  const applySettings = () => {\n    if (rendition) {\n      rendition.themes.default({\n        body: {\n          background: settings.theme,\n          color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\n          'font-family': settings.fontFamily,\n          'font-size': `${settings.fontSize}%`,\n          'font-weight': settings.fontWeight,\n          'line-height': settings.lineHeight,\n          transform: `scale(${settings.zoom / 100})`,\n          'transform-origin': 'top left'\n        },\n        'a, a:link, a:visited, a:hover, a:active': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important',\n          'text-decoration': 'none'\n        },\n        '::selection': {\n          'background-color': 'rgba(0, 0, 255, 0.1)',\n          color: 'inherit'\n        },\n        '*': {\n          transition: 'none !important'\n        }\n      });\n      rendition.themes.select('default');\n      if (settings.pageView === 'double') {\n        rendition.spread('auto');\n      } else {\n        rendition.spread('none');\n      }\n    }\n  };\n  const updateSettings = (key, value) => {\n    setSettings(prevSettings => ({\n      ...prevSettings,\n      [key]: value\n    }));\n  };\n  const handleResetSettings = () => {\n    setSettings(defaultSettings);\n  };\n  useEffect(() => {\n    applySettings();\n  }, [settings]);\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user.userId && bookId) {\n      setLastReadingUpdate(Date.now());\n      setIsActive(true);\n\n      // Update every 5 minutes if the page is active\n      const intervalId = setInterval(() => {\n        if (isActive) {\n          updateReadingHistory();\n        }\n      }, 5 * 60 * 1000);\n\n      // Clean up\n      return () => {\n        updateReadingHistory();\n        clearInterval(intervalId);\n      };\n    }\n  }, [user, bookId]);\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.hidden) {\n        setIsActive(false);\n        updateReadingHistory();\n      } else {\n        setIsActive(true);\n        setLastReadingUpdate(Date.now());\n      }\n    };\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, []);\n  useEffect(() => {\n    const epubUrl = `https://www.gutenberg.org/cache/epub/${bookId}/pg${bookId}.epub`;\n    setEpubUrl(epubUrl);\n    getUser();\n  }, [bookId]);\n  useEffect(() => {\n    const handleBeforeUnload = () => {\n      updateReadingHistory();\n    };\n    window.addEventListener('beforeunload', handleBeforeUnload);\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n    };\n  }, []);\n  useEffect(() => {\n    getBookmark();\n  }, [user]);\n  useEffect(() => {\n    if (user && bookId) {\n      getNotes();\n    }\n  }, [user, bookId, rendition, isNote]);\n  useEffect(() => {\n    if (rendition) {\n      const handleSelection = (cfiRange, contents) => {\n        const selection = contents.window.getSelection();\n        const range = selection.getRangeAt(0);\n        const text = selection.toString().trim();\n        if (text) {\n          setSelectedText(text);\n          setSelectedCfiRange(cfiRange);\n          const rect = range.getBoundingClientRect();\n          const viewportHeight = window.innerHeight;\n          const viewportWidth = window.innerWidth;\n          setPopoverAnchor({\n            top: rect.top < viewportHeight / 2 ? rect.bottom + window.scrollY + 115 : rect.top + window.scrollY - 60,\n            left: viewportWidth / 2 + 5\n          });\n        }\n      };\n      rendition.on('selected', handleSelection);\n      rendition.themes.default({\n        '::selection': {\n          background: 'rgba(0, 0, 255, 0.1)',\n          // Light blue on selection\n          color: 'inherit'\n        },\n        'a:link': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important'\n        },\n        'a:hover': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important'\n        }\n      });\n      rendition.on('rendered', section => {\n        section.document.addEventListener('click', () => {\n          const highlightElements = section.document.querySelectorAll('.highlight');\n          highlightElements.forEach(el => {\n            el.style.transition = 'background-color 0.3s ease';\n          });\n        });\n      });\n      return () => {\n        rendition.off('selected', handleSelection);\n      };\n    }\n  }, [rendition]);\n  useEffect(() => {\n    if (rendition) {\n      const applyHighlights = () => {\n        rendition.views().forEach(view => {\n          selections.forEach(note => {\n            try {\n              const cfiRange = new ePub.CFI(note.cfiRange);\n              const range = cfiRange.toRange(view.document);\n              if (range) {\n                const newHighlight = view.document.createElement('div');\n                newHighlight.setAttribute('style', `\n                background-color: ${note.color};\n                opacity: 0.3;\n                position: absolute;\n                z-index: -1;\n                pointer-events: none;\n                `);\n                const rects = range.getClientRects();\n                for (let i = 0; i < rects.length; i++) {\n                  const rect = rects[i];\n                  const highlightClone = newHighlight.cloneNode();\n                  highlightClone.style.left = `${rect.left}px`;\n                  highlightClone.style.top = `${rect.top}px`;\n                  highlightClone.style.height = `${rect.height}px`;\n                  highlightClone.style.width = `${rect.width}px`;\n                  view.document.body.appendChild(highlightClone);\n                }\n              }\n            } catch (error) {\n              console.error('Error applying highlight:', error);\n            }\n          });\n        });\n      };\n      rendition.on('rendered', section => {\n        applyHighlights();\n      });\n      rendition.on('relocated', location => {\n        applyHighlights();\n      });\n    }\n  }, [rendition, selections]);\n  const handleSave = async () => {\n    if (comment && selectedCfiRange) {\n      const newNote = {\n        userId: user.userId,\n        bookId: bookId,\n        content: comment,\n        selectedText: selectedText,\n        cfiRange: selectedCfiRange,\n        color: highlightColor\n      };\n      try {\n        const response = await axios.post('http://localhost:8080/api/v1/note', newNote, {\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        const createdNote = response.data;\n        setSelections(prev => [...prev, createdNote]);\n        setIsNote(!isNote);\n        rendition.annotations.add('highlight', selectedCfiRange, {}, null, 'hl', {\n          fill: highlightColor,\n          'fill-opacity': '0.3',\n          'mix-blend-mode': 'multiply'\n        });\n        rendition.views().forEach(view => {\n          const highlights = view.document.querySelectorAll('mark[data-epubjs-annotation=\"highlight\"]');\n          highlights.forEach(highlight => {\n            if (highlight.dataset.epubcfi === selectedCfiRange) {\n              highlight.style.backgroundColor = highlightColor;\n              highlight.style.opacity = '0.3';\n            }\n          });\n        });\n        setPopoverAnchor(null);\n        setComment('');\n        setSelectedText('');\n        setSelectedCfiRange('');\n      } catch (error) {\n        console.error('Error creating note:', error);\n      }\n    }\n  };\n  const handleRemoveHighlight = async (cfiRange, noteId) => {\n    try {\n      await axios.delete(`http://localhost:8080/api/v1/note/${noteId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setSelections(selections.filter(s => s.cfiRange !== cfiRange));\n      rendition.annotations.remove(cfiRange);\n    } catch (error) {\n      console.error('Error deleting note:', error);\n    }\n  };\n  const filteredSelections = Array.isArray(selections) ? selections.filter(selection => {\n    var _selection$selectedTe, _selection$selectedTe2, _selection$content$to, _selection$content;\n    const isTextMatch = ((_selection$selectedTe = (_selection$selectedTe2 = selection.selectedText) === null || _selection$selectedTe2 === void 0 ? void 0 : _selection$selectedTe2.toLowerCase().includes(searchTerm.toLowerCase())) !== null && _selection$selectedTe !== void 0 ? _selection$selectedTe : false) || ((_selection$content$to = (_selection$content = selection.content) === null || _selection$content === void 0 ? void 0 : _selection$content.toLowerCase().includes(searchTerm.toLowerCase())) !== null && _selection$content$to !== void 0 ? _selection$content$to : false);\n    const isColorMatch = filter === 'all' || selection.color === filter;\n    return isTextMatch && isColorMatch;\n  }).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)) // Sắp xếp theo thời gian, mới nhất trước\n  : [];\n  const readerStyles = {\n    ...ReactReaderStyle,\n    readerArea: {\n      ...ReactReaderStyle.readerArea,\n      backgroundColor: settings.theme,\n      color: settings.theme === '#121212' ? '#FFFFFF' : '#000000'\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    style: {\n      height: '100vh',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    children: [/*#__PURE__*/_jsxDEV(ReaderHeader, {\n      title: bookTitle,\n      onBack: () => navigate(-1),\n      onToggleNotes: handleToggleDrawer,\n      onToggleSettings: handleSettingsDrawerToggle,\n      user: user,\n      onToggleBookmark: handleToggleBookmark,\n      hasBookmark: hasBookmark,\n      currentLocation: currentLocation\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 609,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 619,\n      columnNumber: 19\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 620,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(ReaderContent, {\n      epubUrl: epubUrl,\n      location: loca,\n      onLocationChanged: loc => setLocation(loc),\n      onGetRendition: _rendition => {\n        setRendition(_rendition);\n        _rendition.on('started', () => setLoading(false));\n      },\n      onError: handleError,\n      readerStyles: readerStyles\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 621,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(NotePopover, {\n      anchorPosition: popoverAnchor,\n      open: Boolean(popoverAnchor),\n      onClose: () => setPopoverAnchor(null),\n      colors: colors,\n      highlightColor: highlightColor,\n      setHighlightColor: setHighlightColor,\n      comment: comment,\n      setComment: setComment,\n      onSave: handleSave\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 632,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(NotesDrawer, {\n      open: drawerOpen,\n      onClose: handleToggleDrawer,\n      searchTerm: searchTerm,\n      setSearchTerm: setSearchTerm,\n      filter: filter,\n      setFilter: setFilter,\n      colors: colors,\n      filteredSelections: filteredSelections,\n      rendition: rendition,\n      onRemoveHighlight: handleRemoveHighlight,\n      onEditNote: handleEditNote\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 643,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: Boolean(editingNote),\n      onClose: () => setEditingNote(null),\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Edit Note\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 658,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          autoFocus: true,\n          margin: \"dense\",\n          label: \"Comment\",\n          fullWidth: true,\n          multiline: true,\n          rows: 4,\n          value: (editingNote === null || editingNote === void 0 ? void 0 : editingNote.content) || '',\n          onChange: e => setEditingNote({\n            ...editingNote,\n            content: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 660,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          value: (editingNote === null || editingNote === void 0 ? void 0 : editingNote.color) || colors[0],\n          onChange: e => setEditingNote({\n            ...editingNote,\n            color: e.target.value\n          }),\n          fullWidth: true,\n          style: {\n            marginTop: '10px'\n          },\n          children: colors.map((color, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: color,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                backgroundColor: color,\n                padding: '2px 10px',\n                borderRadius: '5px',\n                color: color\n              },\n              children: `ColorColorColorColorColorColori`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 681,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 680,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 672,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 659,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setEditingNote(null),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 695,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSaveEdit,\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 696,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 694,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 657,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SettingsDrawer, {\n      open: settingsDrawerOpen,\n      onClose: handleSettingsDrawerToggle,\n      settings: settings,\n      updateSettings: updateSettings,\n      themes: themes,\n      fontFamilies: fontFamilies,\n      onResetSettings: handleResetSettings\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 699,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 606,\n    columnNumber: 5\n  }, this);\n}\n_s(ReadBookScreen, \"T7qRbFzkQ+onzMiZTvS3/9M149Q=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = ReadBookScreen;\nexport default ReadBookScreen;\nvar _c;\n$RefreshReg$(_c, \"ReadBookScreen\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","ReactReaderStyle","ePub","ReaderHeader","ReaderContent","NotePopover","NotesDrawer","SettingsDrawer","Button","Select","MenuItem","TextField","DialogActions","Dialog","DialogTitle","DialogContent","axios","toast","jsxDEV","_jsxDEV","colors","themes","fontFamilies","defaultSettings","theme","pageView","fontFamily","fontSize","fontWeight","lineHeight","zoom","ReadBookScreen","_s","navigate","location","loca","setLocation","bookId","bookTitle","state","error","setError","loading","setLoading","epubUrl","setEpubUrl","selections","setSelections","drawerOpen","setDrawerOpen","rendition","setRendition","highlightColor","setHighlightColor","comment","setComment","popoverAnchor","setPopoverAnchor","selectedText","setSelectedText","selectedCfiRange","setSelectedCfiRange","searchTerm","setSearchTerm","filter","setFilter","editingNote","setEditingNote","settingsDrawerOpen","setSettingsDrawerOpen","settings","setSettings","user","setUser","isNote","setIsNote","hasBookmark","setHasBookmark","currentLocation","setCurrentLocation","readStartTime","setReadStartTime","bookmarkId","setBookmarkId","totalTimeSpent","setTotalTimeSpent","lastReadingUpdate","setLastReadingUpdate","isActive","setIsActive","startReadingSession","Date","now","updateReadingHistory","currentTime","timeSpent","Math","floor","post","userId","headers","Authorization","localStorage","getItem","console","saveBookmark","log","success","getUser","response","get","data","getNotes","notesData","Array","isArray","forEach","note","annotations","add","cfiRange","fill","color","handleEditNote","handleSaveEdit","put","map","s","getBookmark","handleToggleBookmark","handleError","handleToggleDrawer","handleSettingsDrawerToggle","applySettings","default","body","background","transform","transition","select","spread","updateSettings","key","value","prevSettings","handleResetSettings","intervalId","setInterval","clearInterval","handleVisibilityChange","document","hidden","addEventListener","removeEventListener","handleBeforeUnload","window","handleSelection","contents","selection","getSelection","range","getRangeAt","text","toString","trim","rect","getBoundingClientRect","viewportHeight","innerHeight","viewportWidth","innerWidth","top","bottom","scrollY","left","on","section","highlightElements","querySelectorAll","el","style","off","applyHighlights","views","view","CFI","toRange","newHighlight","createElement","setAttribute","rects","getClientRects","i","length","highlightClone","cloneNode","height","width","appendChild","handleSave","newNote","content","createdNote","prev","highlights","highlight","dataset","epubcfi","backgroundColor","opacity","handleRemoveHighlight","noteId","delete","remove","filteredSelections","_selection$selectedTe","_selection$selectedTe2","_selection$content$to","_selection$content","isTextMatch","toLowerCase","includes","isColorMatch","sort","a","b","createdAt","readerStyles","readerArea","className","display","flexDirection","children","title","onBack","onToggleNotes","onToggleSettings","onToggleBookmark","fileName","_jsxFileName","lineNumber","columnNumber","onLocationChanged","loc","onGetRendition","_rendition","onError","anchorPosition","open","Boolean","onClose","onSave","onRemoveHighlight","onEditNote","autoFocus","margin","label","fullWidth","multiline","rows","onChange","e","target","marginTop","index","padding","borderRadius","onClick","onResetSettings","_c","$RefreshReg$"],"sources":["C:/Users/TTC/OneDrive/Documents/GITHUB/fe-readhub/src/pages/read_book/views/ReadBookScreen.js"],"sourcesContent":["import React, {useEffect, useState} from 'react'\r\nimport {useLocation, useNavigate} from 'react-router-dom'\r\nimport {ReactReaderStyle} from 'react-reader'\r\nimport ePub from 'epubjs'\r\nimport ReaderHeader from './ReaderHeader'\r\nimport ReaderContent from './ReaderContent'\r\nimport NotePopover from './NotePopover'\r\nimport NotesDrawer from './NotesDrawer'\r\nimport SettingsDrawer from './SettingsDrawer'\r\nimport {\r\n  Button,\r\n  Select,\r\n  MenuItem,\r\n  TextField,\r\n  DialogActions,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n} from '@mui/material'\r\nimport axios from 'axios'\r\nimport {toast} from 'react-toastify'\r\nimport 'react-toastify/dist/ReactToastify.css'\r\n\r\nconst colors = ['#FFB3BA', '#FFDFBA', '#FFFFBA', '#BAFFC9', '#BAE1FF']\r\nconst themes = ['#FFFFFF', '#F5F5F5', '#121212']\r\nconst fontFamilies = [\r\n  'Arial',\r\n  'Times New Roman',\r\n  'Georgia',\r\n  'Verdana',\r\n  'Roboto',\r\n]\r\nconst defaultSettings = {\r\n  theme: themes[0],\r\n  pageView: 'double',\r\n  fontFamily: fontFamilies[0],\r\n  fontSize: 100,\r\n  fontWeight: 400,\r\n  lineHeight: 1.5,\r\n  zoom: 100,\r\n}\r\n\r\nfunction ReadBookScreen() {\r\n  const navigate = useNavigate()\r\n  const location = useLocation()\r\n  const [loca, setLocation] = useState(location || '')\r\n  const {bookId, bookTitle} = location.state || {}\r\n  const [error, setError] = useState(null)\r\n  const [loading, setLoading] = useState(false)\r\n  const [epubUrl, setEpubUrl] = useState(null)\r\n  const [selections, setSelections] = useState([])\r\n  const [drawerOpen, setDrawerOpen] = useState(false)\r\n  const [rendition, setRendition] = useState(null)\r\n  const [highlightColor, setHighlightColor] = useState(colors[0])\r\n  const [comment, setComment] = useState('')\r\n  const [popoverAnchor, setPopoverAnchor] = useState(null)\r\n  const [selectedText, setSelectedText] = useState('')\r\n  const [selectedCfiRange, setSelectedCfiRange] = useState('')\r\n  const [searchTerm, setSearchTerm] = useState('')\r\n  const [filter, setFilter] = useState('all')\r\n  const [editingNote, setEditingNote] = useState(null)\r\n  const [settingsDrawerOpen, setSettingsDrawerOpen] = useState(false)\r\n  const [settings, setSettings] = useState(defaultSettings)\r\n  const [user, setUser] = useState(null)\r\n  const [isNote, setIsNote] = useState(false)\r\n  const [hasBookmark, setHasBookmark] = useState(false)\r\n  const [currentLocation, setCurrentLocation] = useState(null)\r\n  const [readStartTime, setReadStartTime] = useState(null)\r\n  const [bookmarkId, setBookmarkId] = useState(null)\r\n  const [totalTimeSpent, setTotalTimeSpent] = useState(0)\r\n  const [lastReadingUpdate, setLastReadingUpdate] = useState(null)\r\n  const [isActive, setIsActive] = useState(true)\r\n\r\n  const startReadingSession = () => {\r\n    setReadStartTime(Date.now())\r\n  }\r\n  const updateReadingHistory = async () => {\r\n    const currentTime = Date.now()\r\n    const timeSpent = Math.floor((currentTime - lastReadingUpdate) / 1000) // Convert to seconds\r\n\r\n    // if (timeSpent < 1) return\r\n\r\n    try {\r\n      await axios.post(\r\n        'http://localhost:8080/api/v1/reading-history',\r\n        {\r\n          userId: user.userId,\r\n          bookId: bookId,\r\n          timeSpent: timeSpent,\r\n        },\r\n        {\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n      setLastReadingUpdate(currentTime)\r\n    } catch (error) {\r\n      console.error('Error updating reading history:', error)\r\n    }\r\n  }\r\n\r\n  const saveBookmark = async location => {\r\n    if (!user || !bookId) return\r\n\r\n    try {\r\n      console.log('location', loca)\r\n      await axios.post(\r\n        'http://localhost:8080/api/v1/bookmark',\r\n        {\r\n          userId: user.userId,\r\n          bookId: bookId,\r\n          location: loca,\r\n        },\r\n        {\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n      setHasBookmark(true)\r\n      toast.success('Đã lưu đánh dấu trang')\r\n    } catch (error) {\r\n      console.error('Error saving bookmark:', error)\r\n      toast.error('Có lỗi xảy ra khi lưu đánh dấu trang', 'error')\r\n    }\r\n  }\r\n\r\n  const getUser = async () => {\r\n    if (!localStorage.getItem('token')) return\r\n    try {\r\n      const response = await axios.get(\r\n        'http://localhost:8080/api/v1/user/profile',\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n      setUser(response.data)\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  const getNotes = async () => {\r\n    if (!user?.userId || !bookId || !rendition) return\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:8080/api/v1/note/user/${user.userId}/book/${bookId}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n\r\n      // Extract the data array from the response\r\n      const notesData = Array.isArray(response.data.data)\r\n        ? response.data.data\r\n        : []\r\n      setSelections(notesData)\r\n\r\n      if (rendition) {\r\n        notesData.forEach(note => {\r\n          rendition.annotations.add(\r\n            'highlight',\r\n            note.cfiRange,\r\n            {},\r\n            null,\r\n            'hl',\r\n            {\r\n              fill: note.color,\r\n              'fill-opacity': '0.3',\r\n              'mix-blend-mode': 'multiply',\r\n            },\r\n          )\r\n        })\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching notes:', error)\r\n      setSelections([]) // Set to empty array in case of error\r\n    }\r\n  }\r\n\r\n  const handleEditNote = note => {\r\n    setEditingNote(note)\r\n    console.log('note', note)\r\n  }\r\n  const handleSaveEdit = async () => {\r\n    try {\r\n      await axios.put(`http://localhost:8080/api/v1/note`, editingNote, {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      })\r\n      if (editingNote) {\r\n        setSelections(\r\n          selections.map(s =>\r\n            s.cfiRange === editingNote.cfiRange ? editingNote : s,\r\n          ),\r\n        )\r\n        setEditingNote(null)\r\n      }\r\n      setIsNote(!isNote)\r\n    } catch (error) {\r\n      console.error('Error updating note:', error)\r\n    }\r\n  }\r\n  const getBookmark = async () => {\r\n    if (!user || !bookId) return\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:8080/api/v1/bookmark/user/${user.userId}/book/${bookId}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n\r\n      if (response.data) {\r\n        console.log('bookmark', response.data)\r\n        setHasBookmark(true)\r\n        setBookmarkId(response.data.data.bookmarkId)\r\n        console.log('bookmarkId', bookmarkId)\r\n        setLocation(response.data.data.location)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching bookmark:', error)\r\n    }\r\n  }\r\n\r\n  const handleToggleBookmark = async () => {\r\n    if (!user || !bookId) return\r\n\r\n    if (hasBookmark && bookmarkId) {\r\n      try {\r\n        await axios.put(\r\n          'http://localhost:8080/api/v1/bookmark',\r\n          {\r\n            bookmarkId: bookmarkId,\r\n            userId: user.userId,\r\n            bookId: bookId,\r\n            location: loca,\r\n          },\r\n          {\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n            },\r\n          },\r\n        )\r\n        toast.success('Đã đánh dấu trang')\r\n      } catch (error) {\r\n        toast.error('Có lỗi xảy ra khi đánh dấu trang', 'error')\r\n      }\r\n    } else {\r\n      await saveBookmark(currentLocation)\r\n    }\r\n  }\r\n\r\n  const handleError = error => {\r\n    console.error('Error in ReactReader:', error)\r\n    setError(\r\n      'An error occurred while loading the book. Please try again later.',\r\n    )\r\n    setLoading(false)\r\n  }\r\n\r\n  const handleToggleDrawer = () => {\r\n    setDrawerOpen(!drawerOpen)\r\n  }\r\n  const handleSettingsDrawerToggle = () => {\r\n    setSettingsDrawerOpen(!settingsDrawerOpen)\r\n  }\r\n\r\n  const applySettings = () => {\r\n    if (rendition) {\r\n      rendition.themes.default({\r\n        body: {\r\n          background: settings.theme,\r\n          color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\r\n          'font-family': settings.fontFamily,\r\n          'font-size': `${settings.fontSize}%`,\r\n          'font-weight': settings.fontWeight,\r\n          'line-height': settings.lineHeight,\r\n          transform: `scale(${settings.zoom / 100})`,\r\n          'transform-origin': 'top left',\r\n        },\r\n        'a, a:link, a:visited, a:hover, a:active': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n          'text-decoration': 'none',\r\n        },\r\n        '::selection': {\r\n          'background-color': 'rgba(0, 0, 255, 0.1)',\r\n          color: 'inherit',\r\n        },\r\n        '*': {\r\n          transition: 'none !important',\r\n        },\r\n      })\r\n\r\n      rendition.themes.select('default')\r\n\r\n      if (settings.pageView === 'double') {\r\n        rendition.spread('auto')\r\n      } else {\r\n        rendition.spread('none')\r\n      }\r\n    }\r\n  }\r\n\r\n  const updateSettings = (key, value) => {\r\n    setSettings(prevSettings => ({\r\n      ...prevSettings,\r\n      [key]: value,\r\n    }))\r\n  }\r\n\r\n  const handleResetSettings = () => {\r\n    setSettings(defaultSettings)\r\n  }\r\n\r\n  useEffect(() => {\r\n    applySettings()\r\n  }, [settings])\r\n\r\n  useEffect(() => {\r\n    if (user?.userId && bookId) {\r\n      setLastReadingUpdate(Date.now())\r\n      setIsActive(true)\r\n\r\n      // Update every 5 minutes if the page is active\r\n      const intervalId = setInterval(() => {\r\n        if (isActive) {\r\n          updateReadingHistory()\r\n        }\r\n      }, 5 * 60 * 1000)\r\n\r\n      // Clean up\r\n      return () => {\r\n        updateReadingHistory()\r\n        clearInterval(intervalId)\r\n      }\r\n    }\r\n  }, [user, bookId])\r\n\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      if (document.hidden) {\r\n        setIsActive(false)\r\n        updateReadingHistory()\r\n      } else {\r\n        setIsActive(true)\r\n        setLastReadingUpdate(Date.now())\r\n      }\r\n    }\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange)\r\n    return () => {\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const epubUrl = `https://www.gutenberg.org/cache/epub/${bookId}/pg${bookId}.epub`\r\n    setEpubUrl(epubUrl)\r\n    getUser()\r\n  }, [bookId])\r\n\r\n  useEffect(() => {\r\n    const handleBeforeUnload = () => {\r\n      updateReadingHistory()\r\n    }\r\n\r\n    window.addEventListener('beforeunload', handleBeforeUnload)\r\n    return () => {\r\n      window.removeEventListener('beforeunload', handleBeforeUnload)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    getBookmark()\r\n  }, [user])\r\n\r\n  useEffect(() => {\r\n    if (user && bookId) {\r\n      getNotes()\r\n    }\r\n  }, [user, bookId, rendition, isNote])\r\n\r\n  useEffect(() => {\r\n    if (rendition) {\r\n      const handleSelection = (cfiRange, contents) => {\r\n        const selection = contents.window.getSelection()\r\n        const range = selection.getRangeAt(0)\r\n        const text = selection.toString().trim()\r\n        if (text) {\r\n          setSelectedText(text)\r\n          setSelectedCfiRange(cfiRange)\r\n          const rect = range.getBoundingClientRect()\r\n          const viewportHeight = window.innerHeight\r\n          const viewportWidth = window.innerWidth\r\n          setPopoverAnchor({\r\n            top:\r\n              rect.top < viewportHeight / 2\r\n                ? rect.bottom + window.scrollY + 115\r\n                : rect.top + window.scrollY - 60,\r\n            left: viewportWidth / 2 + 5,\r\n          })\r\n        }\r\n      }\r\n\r\n      rendition.on('selected', handleSelection)\r\n\r\n      rendition.themes.default({\r\n        '::selection': {\r\n          background: 'rgba(0, 0, 255, 0.1)', // Light blue on selection\r\n          color: 'inherit',\r\n        },\r\n        'a:link': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n        },\r\n        'a:hover': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n        },\r\n      })\r\n\r\n      rendition.on('rendered', section => {\r\n        section.document.addEventListener('click', () => {\r\n          const highlightElements =\r\n            section.document.querySelectorAll('.highlight')\r\n          highlightElements.forEach(el => {\r\n            el.style.transition = 'background-color 0.3s ease'\r\n          })\r\n        })\r\n      })\r\n\r\n      return () => {\r\n        rendition.off('selected', handleSelection)\r\n      }\r\n    }\r\n  }, [rendition])\r\n  useEffect(() => {\r\n    if (rendition) {\r\n      const applyHighlights = () => {\r\n        rendition.views().forEach(view => {\r\n          selections.forEach(note => {\r\n            try {\r\n              const cfiRange = new ePub.CFI(note.cfiRange)\r\n              const range = cfiRange.toRange(view.document)\r\n\r\n              if (range) {\r\n                const newHighlight = view.document.createElement('div')\r\n                newHighlight.setAttribute(\r\n                  'style',\r\n                  `\r\n                background-color: ${note.color};\r\n                opacity: 0.3;\r\n                position: absolute;\r\n                z-index: -1;\r\n                pointer-events: none;\r\n                `,\r\n                )\r\n\r\n                const rects = range.getClientRects()\r\n                for (let i = 0; i < rects.length; i++) {\r\n                  const rect = rects[i]\r\n                  const highlightClone = newHighlight.cloneNode()\r\n                  highlightClone.style.left = `${rect.left}px`\r\n                  highlightClone.style.top = `${rect.top}px`\r\n                  highlightClone.style.height = `${rect.height}px`\r\n                  highlightClone.style.width = `${rect.width}px`\r\n                  view.document.body.appendChild(highlightClone)\r\n                }\r\n              }\r\n            } catch (error) {\r\n              console.error('Error applying highlight:', error)\r\n            }\r\n          })\r\n        })\r\n      }\r\n\r\n      rendition.on('rendered', section => {\r\n        applyHighlights()\r\n      })\r\n\r\n      rendition.on('relocated', location => {\r\n        applyHighlights()\r\n      })\r\n    }\r\n  }, [rendition, selections])\r\n\r\n  const handleSave = async () => {\r\n    if (comment && selectedCfiRange) {\r\n      const newNote = {\r\n        userId: user.userId,\r\n        bookId: bookId,\r\n        content: comment,\r\n        selectedText: selectedText,\r\n        cfiRange: selectedCfiRange,\r\n        color: highlightColor,\r\n      }\r\n\r\n      try {\r\n        const response = await axios.post(\r\n          'http://localhost:8080/api/v1/note',\r\n          newNote,\r\n          {\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n            },\r\n          },\r\n        )\r\n\r\n        const createdNote = response.data\r\n\r\n        setSelections(prev => [...prev, createdNote])\r\n        setIsNote(!isNote)\r\n\r\n        rendition.annotations.add(\r\n          'highlight',\r\n          selectedCfiRange,\r\n          {},\r\n          null,\r\n          'hl',\r\n          {\r\n            fill: highlightColor,\r\n            'fill-opacity': '0.3',\r\n            'mix-blend-mode': 'multiply',\r\n          },\r\n        )\r\n\r\n        rendition.views().forEach(view => {\r\n          const highlights = view.document.querySelectorAll(\r\n            'mark[data-epubjs-annotation=\"highlight\"]',\r\n          )\r\n          highlights.forEach(highlight => {\r\n            if (highlight.dataset.epubcfi === selectedCfiRange) {\r\n              highlight.style.backgroundColor = highlightColor\r\n              highlight.style.opacity = '0.3'\r\n            }\r\n          })\r\n        })\r\n\r\n        setPopoverAnchor(null)\r\n        setComment('')\r\n        setSelectedText('')\r\n        setSelectedCfiRange('')\r\n      } catch (error) {\r\n        console.error('Error creating note:', error)\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleRemoveHighlight = async (cfiRange, noteId) => {\r\n    try {\r\n      await axios.delete(`http://localhost:8080/api/v1/note/${noteId}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      })\r\n      setSelections(selections.filter(s => s.cfiRange !== cfiRange))\r\n      rendition.annotations.remove(cfiRange)\r\n    } catch (error) {\r\n      console.error('Error deleting note:', error)\r\n    }\r\n  }\r\n\r\n  const filteredSelections = Array.isArray(selections)\r\n    ? selections\r\n        .filter(selection => {\r\n          const isTextMatch =\r\n            (selection.selectedText\r\n              ?.toLowerCase()\r\n              .includes(searchTerm.toLowerCase()) ??\r\n              false) ||\r\n            (selection.content\r\n              ?.toLowerCase()\r\n              .includes(searchTerm.toLowerCase()) ??\r\n              false)\r\n          const isColorMatch = filter === 'all' || selection.color === filter\r\n          return isTextMatch && isColorMatch\r\n        })\r\n        .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)) // Sắp xếp theo thời gian, mới nhất trước\r\n    : []\r\n\r\n  const readerStyles = {\r\n    ...ReactReaderStyle,\r\n    readerArea: {\r\n      ...ReactReaderStyle.readerArea,\r\n      backgroundColor: settings.theme,\r\n      color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\r\n    },\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className='App'\r\n      style={{height: '100vh', display: 'flex', flexDirection: 'column'}}>\r\n      <ReaderHeader\r\n        title={bookTitle}\r\n        onBack={() => navigate(-1)}\r\n        onToggleNotes={handleToggleDrawer}\r\n        onToggleSettings={handleSettingsDrawerToggle}\r\n        user={user}\r\n        onToggleBookmark={handleToggleBookmark}\r\n        hasBookmark={hasBookmark}\r\n        currentLocation={currentLocation}\r\n      />\r\n      {loading && <p>Loading...</p>}\r\n      {error && <p style={{color: 'red'}}>{error}</p>}\r\n      <ReaderContent\r\n        epubUrl={epubUrl}\r\n        location={loca}\r\n        onLocationChanged={loc => setLocation(loc)}\r\n        onGetRendition={_rendition => {\r\n          setRendition(_rendition)\r\n          _rendition.on('started', () => setLoading(false))\r\n        }}\r\n        onError={handleError}\r\n        readerStyles={readerStyles}\r\n      />\r\n      <NotePopover\r\n        anchorPosition={popoverAnchor}\r\n        open={Boolean(popoverAnchor)}\r\n        onClose={() => setPopoverAnchor(null)}\r\n        colors={colors}\r\n        highlightColor={highlightColor}\r\n        setHighlightColor={setHighlightColor}\r\n        comment={comment}\r\n        setComment={setComment}\r\n        onSave={handleSave}\r\n      />\r\n      <NotesDrawer\r\n        open={drawerOpen}\r\n        onClose={handleToggleDrawer}\r\n        searchTerm={searchTerm}\r\n        setSearchTerm={setSearchTerm}\r\n        filter={filter}\r\n        setFilter={setFilter}\r\n        colors={colors}\r\n        filteredSelections={filteredSelections}\r\n        rendition={rendition}\r\n        onRemoveHighlight={handleRemoveHighlight}\r\n        onEditNote={handleEditNote}\r\n      />\r\n\r\n      <Dialog open={Boolean(editingNote)} onClose={() => setEditingNote(null)}>\r\n        <DialogTitle>Edit Note</DialogTitle>\r\n        <DialogContent>\r\n          <TextField\r\n            autoFocus\r\n            margin='dense'\r\n            label='Comment'\r\n            fullWidth\r\n            multiline\r\n            rows={4}\r\n            value={editingNote?.content || ''}\r\n            onChange={e =>\r\n              setEditingNote({...editingNote, content: e.target.value})\r\n            }\r\n          />\r\n          <Select\r\n            value={editingNote?.color || colors[0]}\r\n            onChange={e =>\r\n              setEditingNote({...editingNote, color: e.target.value})\r\n            }\r\n            fullWidth\r\n            style={{marginTop: '10px'}}>\r\n            {colors.map((color, index) => (\r\n              <MenuItem key={index} value={color}>\r\n                <span\r\n                  style={{\r\n                    backgroundColor: color,\r\n                    padding: '2px 10px',\r\n                    borderRadius: '5px',\r\n                    color: color,\r\n                  }}>\r\n                  {`ColorColorColorColorColorColori`}\r\n                </span>\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setEditingNote(null)}>Cancel</Button>\r\n          <Button onClick={handleSaveEdit}>Save</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <SettingsDrawer\r\n        open={settingsDrawerOpen}\r\n        onClose={handleSettingsDrawerToggle}\r\n        settings={settings}\r\n        updateSettings={updateSettings}\r\n        themes={themes}\r\n        fontFamilies={fontFamilies}\r\n        onResetSettings={handleResetSettings}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ReadBookScreen\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}