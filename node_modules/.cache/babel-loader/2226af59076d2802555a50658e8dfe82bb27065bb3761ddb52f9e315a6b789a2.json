{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TTC\\\\OneDrive\\\\Documents\\\\GITHUB\\\\fe-readhub\\\\src\\\\pages\\\\read_book\\\\views\\\\ReadBookScreen.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { ReactReader, ReactReaderStyle } from 'react-reader';\nimport { AppBar, Toolbar, Typography, Button, Select, MenuItem, Drawer, Popover, TextField, Divider, DialogActions, IconButton, Dialog, DialogTitle, DialogContent, FormControl, InputLabel, Slider, RadioGroup, FormControlLabel, Radio } from '@mui/material';\nimport { ArrowBack, Bookmark, BookmarkBorder, ColorLens, Edit, Settings } from '@mui/icons-material';\nimport ExpandableText from './ExpandableText';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst colors = ['#FFB3BA', '#FFDFBA', '#FFFFBA', '#BAFFC9', '#BAE1FF']; // Pastel colors\nconst themes = ['#FFFFFF', '#F5F5F5', '#121212'];\nconst fontFamilies = ['Arial', 'Times New Roman', 'Georgia', 'Verdana', 'Roboto'];\nconst defaultSettings = {\n  theme: themes[0],\n  pageView: 'double',\n  fontFamily: fontFamilies[0],\n  fontSize: 100,\n  fontWeight: 400,\n  lineHeight: 1.5,\n  zoom: 100\n};\nfunction ReadBookScreen() {\n  _s();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loca, setLocation] = useState(location || '');\n  const {\n    bookId,\n    bookTitle\n  } = location.state || {};\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [epubUrl, setEpubUrl] = useState(null);\n  const [selections, setSelections] = useState([]);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const [rendition, setRendition] = useState(null);\n  const [highlightColor, setHighlightColor] = useState(colors[0]);\n  const [comment, setComment] = useState('');\n  const [popoverAnchor, setPopoverAnchor] = useState(null);\n  const [selectedText, setSelectedText] = useState('');\n  const [selectedCfiRange, setSelectedCfiRange] = useState('');\n  const readerRef = useRef(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filter, setFilter] = useState('all');\n  const [editingNote, setEditingNote] = useState(null);\n  const [bookmarks, setBookmarks] = useState([]);\n  const [theme, setTheme] = useState(themes[0]);\n  const [settingsDrawerOpen, setSettingsDrawerOpen] = useState(false);\n  const [pageView, setPageView] = useState('single');\n  const [fontFamily, setFontFamily] = useState(fontFamilies[0]);\n  const [fontSize, setFontSize] = useState(100);\n  const [fontWeight, setFontWeight] = useState(400);\n  const [lineHeight, setLineHeight] = useState(1.5);\n  const [zoom, setZoom] = useState(100);\n  const [settings, setSettings] = useState(defaultSettings);\n  const handleEditNote = note => {\n    setEditingNote(note);\n  };\n  const handleSaveEdit = () => {\n    if (editingNote) {\n      setSelections(selections.map(s => s.cfiRange === editingNote.cfiRange ? editingNote : s));\n      setEditingNote(null);\n    }\n  };\n  const handleToggleBookmark = cfiRange => {\n    if (bookmarks.includes(cfiRange)) {\n      setBookmarks(bookmarks.filter(b => b !== cfiRange));\n    } else {\n      setBookmarks([...bookmarks, cfiRange]);\n    }\n  };\n  const handleError = error => {\n    console.error('Error in ReactReader:', error);\n    setError('An error occurred while loading the book. Please try again later.');\n    setLoading(false);\n  };\n  const handleToggleDrawer = () => {\n    setDrawerOpen(!drawerOpen);\n  };\n  const handleSettingsDrawerToggle = () => {\n    setSettingsDrawerOpen(!settingsDrawerOpen);\n  };\n  const applySettings = () => {\n    if (rendition) {\n      rendition.themes.default({\n        body: {\n          background: settings.theme,\n          color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\n          'font-family': settings.fontFamily,\n          'font-size': `${settings.fontSize}%`,\n          'font-weight': settings.fontWeight,\n          'line-height': settings.lineHeight,\n          transform: `scale(${settings.zoom / 100})`,\n          'transform-origin': 'top left'\n        },\n        'a, a:link, a:visited, a:hover, a:active': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important',\n          'text-decoration': 'none'\n        },\n        '::selection': {\n          'background-color': 'rgba(0, 0, 255, 0.1)',\n          color: 'inherit'\n        },\n        '*': {\n          transition: 'none !important'\n        }\n      });\n      rendition.themes.select('default');\n      if (settings.pageView === 'double') {\n        rendition.spread('auto');\n      } else {\n        rendition.spread('none');\n      }\n    }\n  };\n  const updateSettings = (key, value) => {\n    setSettings(prevSettings => ({\n      ...prevSettings,\n      [key]: value\n    }));\n  };\n  const handleResetSettings = () => {\n    setSettings(defaultSettings);\n  };\n  useEffect(() => {\n    applySettings();\n  }, [settings]);\n  useEffect(() => {\n    const epubUrl = `https://www.gutenberg.org/cache/epub/${bookId}/pg${bookId}.epub`;\n    setEpubUrl(epubUrl);\n  }, [bookId]);\n  useEffect(() => {\n    if (rendition) {\n      const handleSelection = (cfiRange, contents) => {\n        const selection = contents.window.getSelection();\n        const range = selection.getRangeAt(0);\n        const text = selection.toString().trim();\n        if (text) {\n          setSelectedText(text);\n          setSelectedCfiRange(cfiRange);\n          const rect = range.getBoundingClientRect();\n          const viewportHeight = window.innerHeight;\n          const viewportWidth = window.innerWidth;\n          setPopoverAnchor({\n            top: rect.top < viewportHeight / 2 ? rect.bottom + window.scrollY + 115 : rect.top + window.scrollY - 60,\n            left: viewportWidth / 2 + 5\n          });\n        }\n      };\n      rendition.on('selected', handleSelection);\n      rendition.themes.default({\n        '::selection': {\n          background: 'rgba(0, 0, 255, 0.1)',\n          // Light blue on selection\n          color: 'inherit'\n        },\n        'a:link': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important'\n        },\n        'a:hover': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important'\n        }\n      });\n      rendition.on('rendered', section => {\n        section.document.addEventListener('click', () => {\n          const highlightElements = section.document.querySelectorAll('.highlight');\n          highlightElements.forEach(el => {\n            el.style.transition = 'background-color 0.3s ease';\n          });\n        });\n      });\n      return () => {\n        rendition.off('selected', handleSelection);\n      };\n    }\n  }, [rendition]);\n  const handleSave = () => {\n    if (comment && selectedCfiRange) {\n      const newSelection = {\n        text: selectedText,\n        cfiRange: selectedCfiRange,\n        comment,\n        color: highlightColor,\n        timestamp: Date.now()\n      };\n      setSelections(prev => [...prev, newSelection]);\n      rendition.annotations.remove(selectedCfiRange, 'highlight');\n      rendition.annotations.add('highlight', selectedCfiRange, {}, null, 'hl', {\n        fill: highlightColor,\n        'fill-opacity': '0.3',\n        'mix-blend-mode': 'multiply'\n      });\n      rendition.views().forEach(view => {\n        const highlights = view.document.querySelectorAll('mark[data-epubjs-annotation=\"highlight\"]');\n        highlights.forEach(highlight => {\n          if (highlight.dataset.epubcfi === selectedCfiRange) {\n            highlight.style.backgroundColor = highlightColor;\n            highlight.style.opacity = '0.3';\n          }\n        });\n      });\n      setPopoverAnchor(null);\n      setComment('');\n      setSelectedText('');\n      setSelectedCfiRange('');\n    }\n  };\n  const handleRemoveHighlight = cfiRange => {\n    rendition.annotations.remove(cfiRange, 'highlight');\n    setSelections(selections.filter(selection => selection.cfiRange !== cfiRange));\n  };\n  const filteredSelections = selections.filter(selection => {\n    const isTextMatch = selection.text.toLowerCase().includes(searchTerm.toLowerCase()) || selection.comment.toLowerCase().includes(searchTerm.toLowerCase());\n    const isColorMatch = filter === 'all' || selection.color === filter;\n    return isTextMatch && isColorMatch;\n  }).sort((a, b) => b.timestamp - a.timestamp);\n  const readerStyles = {\n    ...ReactReaderStyle,\n    readerArea: {\n      ...ReactReaderStyle.readerArea,\n      backgroundColor: settings.theme,\n      color: settings.theme === '#121212' ? '#FFFFFF' : '#000000'\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    style: {\n      height: '100vh',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    children: [/*#__PURE__*/_jsxDEV(AppBar, {\n      position: \"static\",\n      children: /*#__PURE__*/_jsxDEV(Toolbar, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          color: \"inherit\",\n          onClick: () => navigate(-1),\n          children: [/*#__PURE__*/_jsxDEV(ArrowBack, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this), \"Back\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          style: {\n            flexGrow: 1,\n            textAlign: 'center'\n          },\n          children: bookTitle || 'Epub Reader'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          color: \"inherit\",\n          onClick: handleToggleDrawer,\n          children: [/*#__PURE__*/_jsxDEV(ColorLens, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 13\n          }, this), \"Notes\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          color: \"inherit\",\n          onClick: handleSettingsDrawerToggle,\n          children: [/*#__PURE__*/_jsxDEV(Settings, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 13\n          }, this), \"Settings\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 19\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        position: 'relative'\n      },\n      ref: readerRef,\n      children: /*#__PURE__*/_jsxDEV(ReactReader, {\n        url: epubUrl,\n        epubOptions: {\n          allowPopups: true,\n          allowScriptedContent: true\n        },\n        location: loca,\n        locationChanged: loc => setLocation(loc),\n        getRendition: _rendition => {\n          setRendition(_rendition);\n          _rendition.on('started', () => setLoading(false));\n        },\n        handleError: handleError,\n        readerStyles: readerStyles\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Popover, {\n      open: Boolean(popoverAnchor),\n      anchorReference: \"anchorPosition\",\n      anchorPosition: popoverAnchor,\n      onClose: () => setPopoverAnchor(null),\n      anchorOrigin: {\n        vertical: 'bottom',\n        horizontal: 'center'\n      },\n      transformOrigin: {\n        vertical: 'top',\n        horizontal: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '10px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '10px',\n            marginBottom: '10px'\n          },\n          children: colors.map((color, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: () => setHighlightColor(color),\n            style: {\n              width: '20px',\n              height: '20px',\n              backgroundColor: color,\n              border: color === highlightColor ? '2px solid black' : '',\n              cursor: 'pointer'\n            }\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          label: \"Comment\",\n          fullWidth: true,\n          multiline: true,\n          rows: 2,\n          value: comment,\n          onChange: e => setComment(e.target.value),\n          style: {\n            marginBottom: '10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSave,\n          disabled: !comment,\n          color: \"primary\",\n          variant: \"contained\",\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Drawer, {\n      anchor: \"right\",\n      open: drawerOpen,\n      onClose: handleToggleDrawer,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 350\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            paddingTop: '20px',\n            paddingLeft: '20px',\n            paddingRight: '20px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            style: {\n              marginBottom: '10px'\n            },\n            children: \"Notes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            label: \"Search Notes\",\n            value: searchTerm,\n            onChange: e => setSearchTerm(e.target.value),\n            fullWidth: true,\n            style: {\n              marginBottom: '10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            value: filter,\n            onChange: e => setFilter(e.target.value),\n            fullWidth: true,\n            style: {\n              marginBottom: '10px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n              value: \"all\",\n              style: {\n                paddingLeft: '20px',\n                paddingRight: '20px'\n              },\n              children: \"All Colors\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 416,\n              columnNumber: 15\n            }, this), colors.map((color, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: color,\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  backgroundColor: color,\n                  padding: '2px 10px',\n                  borderRadius: '5px',\n                  color: color\n                },\n                children: `ColorColorColorColorColorColori`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 423,\n                columnNumber: 19\n              }, this)\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 17\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Divider, {\n          style: {\n            margin: '10px 0'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            maxHeight: 'calc(100vh - 215px)',\n            overflowY: 'auto',\n            paddingLeft: '20px'\n          },\n          children: filteredSelections.map((note, i) => {\n            const {\n              text,\n              cfiRange,\n              comment,\n              color,\n              timestamp\n            } = note;\n            const isLastNote = i === filteredSelections.length - 1;\n            const isBookmarked = bookmarks.includes(cfiRange);\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '15px',\n                paddingBottom: '10px',\n                paddingRight: '10px',\n                borderBottom: isLastNote ? 'none' : '1px solid #eee'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  backgroundColor: color,\n                  padding: '7px',\n                  borderRadius: '5px',\n                  marginBottom: '7px'\n                },\n                children: /*#__PURE__*/_jsxDEV(ExpandableText, {\n                  text: text,\n                  maxLength: 190\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 463,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ExpandableText, {\n                text: comment,\n                maxLength: 190\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 465,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"caption\",\n                style: {\n                  textAlign: 'right',\n                  display: 'block',\n                  marginTop: '7px'\n                },\n                children: new Date(timestamp).toLocaleString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                size: \"small\",\n                onClick: () => rendition.display(cfiRange),\n                style: {\n                  marginRight: '5px'\n                },\n                variant: \"outlined\",\n                children: \"Show\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                size: \"small\",\n                onClick: () => handleRemoveHighlight(cfiRange),\n                variant: \"outlined\",\n                color: \"secondary\",\n                style: {\n                  marginRight: '80px'\n                },\n                children: \"Remove\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n                size: \"small\",\n                onClick: () => handleEditNote(note),\n                style: {\n                  marginRight: '5px'\n                },\n                children: /*#__PURE__*/_jsxDEV(Edit, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 490,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n                size: \"small\",\n                onClick: () => handleToggleBookmark(cfiRange),\n                children: isBookmarked ? /*#__PURE__*/_jsxDEV(Bookmark, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 499,\n                  columnNumber: 37\n                }, this) : /*#__PURE__*/_jsxDEV(BookmarkBorder, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 499,\n                  columnNumber: 52\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 496,\n                columnNumber: 19\n              }, this)]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: Boolean(editingNote),\n      onClose: () => setEditingNote(null),\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Edit Note\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 509,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          autoFocus: true,\n          margin: \"dense\",\n          label: \"Comment\",\n          fullWidth: true,\n          multiline: true,\n          rows: 4,\n          value: (editingNote === null || editingNote === void 0 ? void 0 : editingNote.comment) || '',\n          onChange: e => setEditingNote({\n            ...editingNote,\n            comment: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 511,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          value: (editingNote === null || editingNote === void 0 ? void 0 : editingNote.color) || colors[0],\n          onChange: e => setEditingNote({\n            ...editingNote,\n            color: e.target.value\n          }),\n          fullWidth: true,\n          style: {\n            marginTop: '10px'\n          },\n          children: colors.map((color, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: color,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                backgroundColor: color,\n                padding: '2px 10px',\n                borderRadius: '5px',\n                color: color\n              },\n              children: `ColorColorColorColorColorColori`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 532,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setEditingNote(null),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSaveEdit,\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 545,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Drawer, {\n      anchor: \"right\",\n      open: settingsDrawerOpen,\n      onClose: handleSettingsDrawerToggle,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 350,\n          paddingTop: 15,\n          paddingLeft: 25,\n          paddingRight: 25\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          gutterBottom: true,\n          style: {\n            marginBottom: -5\n          },\n          children: \"Settings\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 561,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          margin: \"normal\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            gutterBottom: true,\n            children: \"Theme\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 565,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            value: settings.theme,\n            onChange: e => updateSettings('theme', e.target.value),\n            children: themes.map((t, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: t,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  width: 20,\n                  height: 20,\n                  backgroundColor: t,\n                  border: '1px solid #000',\n                  display: 'inline-block',\n                  marginRight: 10,\n                  marginBottom: -5\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 571,\n                columnNumber: 19\n              }, this), t === '#FFFFFF' ? 'White' : t === '#F5F5F5' ? 'Light Gray' : t === '#E0E0E0' ? 'Gray' : 'Dark']\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 570,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 566,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 564,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          margin: \"normal\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            gutterBottom: true,\n            style: {\n              marginBottom: -5\n            },\n            children: \"Page View\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 594,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(RadioGroup, {\n            row: true,\n            value: settings.pageView,\n            style: {\n              marginBottom: -10\n            },\n            onChange: e => updateSettings('pageView', e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(FormControlLabel, {\n              value: \"single\",\n              control: /*#__PURE__*/_jsxDEV(Radio, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 604,\n                columnNumber: 26\n              }, this),\n              label: \"Single\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n              value: \"double\",\n              control: /*#__PURE__*/_jsxDEV(Radio, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 609,\n                columnNumber: 26\n              }, this),\n              label: \"Double\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 607,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          margin: \"normal\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            gutterBottom: true,\n            children: \"Font Family\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 615,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            value: settings.fontFamily,\n            onChange: e => updateSettings('fontFamily', e.target.value),\n            children: fontFamilies.map((font, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: font,\n              style: {\n                fontFamily: font\n              },\n              children: font\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 620,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 614,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          margin: \"normal\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            gutterBottom: true,\n            children: [\"Font Size: \", settings.fontSize, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 627,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Slider, {\n            value: settings.fontSize,\n            onChange: (_, newValue) => updateSettings('fontSize', newValue),\n            min: 50,\n            max: 200,\n            step: 10\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 630,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 626,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          margin: \"normal\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            gutterBottom: true,\n            children: [\"Font Weight: \", settings.fontWeight]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 639,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Slider, {\n            value: settings.fontWeight,\n            onChange: (_, newValue) => updateSettings('fontWeight', newValue),\n            min: 100,\n            max: 900,\n            step: 100\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 642,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          margin: \"normal\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            gutterBottom: true,\n            children: [\"Line Height: \", settings.lineHeight]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 651,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Slider, {\n            value: settings.lineHeight,\n            onChange: (_, newValue) => updateSettings('lineHeight', newValue),\n            min: 1,\n            max: 3,\n            step: 0.1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 654,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 650,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n          fullWidth: true,\n          margin: \"normal\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            gutterBottom: true,\n            children: [\"Zoom: \", settings.zoom, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 663,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Slider, {\n            value: settings.zoom,\n            onChange: (_, newValue) => updateSettings('zoom', newValue),\n            min: 50,\n            max: 200,\n            step: 10\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 664,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 662,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"secondary\",\n          fullWidth: true,\n          onClick: handleResetSettings,\n          style: {\n            marginTop: 5\n          },\n          children: \"Reset Settings\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 672,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 301,\n    columnNumber: 5\n  }, this);\n}\n_s(ReadBookScreen, \"m77645+GGrcFN3t+OjTKZ95mnvo=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = ReadBookScreen;\nexport default ReadBookScreen;\nvar _c;\n$RefreshReg$(_c, \"ReadBookScreen\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useLocation","useNavigate","ReactReader","ReactReaderStyle","AppBar","Toolbar","Typography","Button","Select","MenuItem","Drawer","Popover","TextField","Divider","DialogActions","IconButton","Dialog","DialogTitle","DialogContent","FormControl","InputLabel","Slider","RadioGroup","FormControlLabel","Radio","ArrowBack","Bookmark","BookmarkBorder","ColorLens","Edit","Settings","ExpandableText","jsxDEV","_jsxDEV","colors","themes","fontFamilies","defaultSettings","theme","pageView","fontFamily","fontSize","fontWeight","lineHeight","zoom","ReadBookScreen","_s","navigate","location","loca","setLocation","bookId","bookTitle","state","error","setError","loading","setLoading","epubUrl","setEpubUrl","selections","setSelections","drawerOpen","setDrawerOpen","rendition","setRendition","highlightColor","setHighlightColor","comment","setComment","popoverAnchor","setPopoverAnchor","selectedText","setSelectedText","selectedCfiRange","setSelectedCfiRange","readerRef","searchTerm","setSearchTerm","filter","setFilter","editingNote","setEditingNote","bookmarks","setBookmarks","setTheme","settingsDrawerOpen","setSettingsDrawerOpen","setPageView","setFontFamily","setFontSize","setFontWeight","setLineHeight","setZoom","settings","setSettings","handleEditNote","note","handleSaveEdit","map","s","cfiRange","handleToggleBookmark","includes","b","handleError","console","handleToggleDrawer","handleSettingsDrawerToggle","applySettings","default","body","background","color","transform","transition","select","spread","updateSettings","key","value","prevSettings","handleResetSettings","handleSelection","contents","selection","window","getSelection","range","getRangeAt","text","toString","trim","rect","getBoundingClientRect","viewportHeight","innerHeight","viewportWidth","innerWidth","top","bottom","scrollY","left","on","section","document","addEventListener","highlightElements","querySelectorAll","forEach","el","style","off","handleSave","newSelection","timestamp","Date","now","prev","annotations","remove","add","fill","views","view","highlights","highlight","dataset","epubcfi","backgroundColor","opacity","handleRemoveHighlight","filteredSelections","isTextMatch","toLowerCase","isColorMatch","sort","a","readerStyles","readerArea","className","height","display","flexDirection","children","position","onClick","fileName","_jsxFileName","lineNumber","columnNumber","variant","flexGrow","textAlign","flex","ref","url","epubOptions","allowPopups","allowScriptedContent","locationChanged","loc","getRendition","_rendition","open","Boolean","anchorReference","anchorPosition","onClose","anchorOrigin","vertical","horizontal","transformOrigin","padding","gap","marginBottom","i","width","border","cursor","label","fullWidth","multiline","rows","onChange","e","target","disabled","anchor","paddingTop","paddingLeft","paddingRight","index","borderRadius","margin","maxHeight","overflowY","isLastNote","length","isBookmarked","paddingBottom","borderBottom","maxLength","marginTop","toLocaleString","size","marginRight","autoFocus","gutterBottom","t","row","control","font","_","newValue","min","max","step","_c","$RefreshReg$"],"sources":["C:/Users/TTC/OneDrive/Documents/GITHUB/fe-readhub/src/pages/read_book/views/ReadBookScreen.js"],"sourcesContent":["import React, {useEffect, useState, useRef} from 'react'\r\nimport {useLocation, useNavigate} from 'react-router-dom'\r\nimport {ReactReader, ReactReaderStyle} from 'react-reader'\r\nimport {\r\n  AppBar,\r\n  Toolbar,\r\n  Typography,\r\n  Button,\r\n  Select,\r\n  MenuItem,\r\n  Drawer,\r\n  Popover,\r\n  TextField,\r\n  Divider,\r\n  DialogActions,\r\n  IconButton,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  FormControl,\r\n  InputLabel,\r\n  Slider,\r\n  RadioGroup,\r\n  FormControlLabel,\r\n  Radio,\r\n} from '@mui/material'\r\nimport {\r\n  ArrowBack,\r\n  Bookmark,\r\n  BookmarkBorder,\r\n  ColorLens,\r\n  Edit,\r\n  Settings,\r\n} from '@mui/icons-material'\r\nimport ExpandableText from './ExpandableText'\r\n\r\nconst colors = ['#FFB3BA', '#FFDFBA', '#FFFFBA', '#BAFFC9', '#BAE1FF'] // Pastel colors\r\nconst themes = ['#FFFFFF', '#F5F5F5', '#121212']\r\nconst fontFamilies = [\r\n  'Arial',\r\n  'Times New Roman',\r\n  'Georgia',\r\n  'Verdana',\r\n  'Roboto',\r\n]\r\nconst defaultSettings = {\r\n  theme: themes[0],\r\n  pageView: 'double',\r\n  fontFamily: fontFamilies[0],\r\n  fontSize: 100,\r\n  fontWeight: 400,\r\n  lineHeight: 1.5,\r\n  zoom: 100,\r\n}\r\n\r\nfunction ReadBookScreen() {\r\n  const navigate = useNavigate()\r\n  const location = useLocation()\r\n  const [loca, setLocation] = useState(location || '')\r\n  const {bookId, bookTitle} = location.state || {}\r\n  const [error, setError] = useState(null)\r\n  const [loading, setLoading] = useState(false)\r\n  const [epubUrl, setEpubUrl] = useState(null)\r\n  const [selections, setSelections] = useState([])\r\n  const [drawerOpen, setDrawerOpen] = useState(false)\r\n  const [rendition, setRendition] = useState(null)\r\n  const [highlightColor, setHighlightColor] = useState(colors[0])\r\n  const [comment, setComment] = useState('')\r\n  const [popoverAnchor, setPopoverAnchor] = useState(null)\r\n  const [selectedText, setSelectedText] = useState('')\r\n  const [selectedCfiRange, setSelectedCfiRange] = useState('')\r\n  const readerRef = useRef(null)\r\n  const [searchTerm, setSearchTerm] = useState('')\r\n  const [filter, setFilter] = useState('all')\r\n  const [editingNote, setEditingNote] = useState(null)\r\n  const [bookmarks, setBookmarks] = useState([])\r\n  const [theme, setTheme] = useState(themes[0])\r\n  const [settingsDrawerOpen, setSettingsDrawerOpen] = useState(false)\r\n  const [pageView, setPageView] = useState('single')\r\n  const [fontFamily, setFontFamily] = useState(fontFamilies[0])\r\n  const [fontSize, setFontSize] = useState(100)\r\n  const [fontWeight, setFontWeight] = useState(400)\r\n  const [lineHeight, setLineHeight] = useState(1.5)\r\n  const [zoom, setZoom] = useState(100)\r\n  const [settings, setSettings] = useState(defaultSettings)\r\n\r\n  const handleEditNote = note => {\r\n    setEditingNote(note)\r\n  }\r\n  const handleSaveEdit = () => {\r\n    if (editingNote) {\r\n      setSelections(\r\n        selections.map(s =>\r\n          s.cfiRange === editingNote.cfiRange ? editingNote : s,\r\n        ),\r\n      )\r\n      setEditingNote(null)\r\n    }\r\n  }\r\n\r\n  const handleToggleBookmark = cfiRange => {\r\n    if (bookmarks.includes(cfiRange)) {\r\n      setBookmarks(bookmarks.filter(b => b !== cfiRange))\r\n    } else {\r\n      setBookmarks([...bookmarks, cfiRange])\r\n    }\r\n  }\r\n\r\n  const handleError = error => {\r\n    console.error('Error in ReactReader:', error)\r\n    setError(\r\n      'An error occurred while loading the book. Please try again later.',\r\n    )\r\n    setLoading(false)\r\n  }\r\n\r\n  const handleToggleDrawer = () => {\r\n    setDrawerOpen(!drawerOpen)\r\n  }\r\n  const handleSettingsDrawerToggle = () => {\r\n    setSettingsDrawerOpen(!settingsDrawerOpen)\r\n  }\r\n\r\n  const applySettings = () => {\r\n    if (rendition) {\r\n      rendition.themes.default({\r\n        body: {\r\n          background: settings.theme,\r\n          color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\r\n          'font-family': settings.fontFamily,\r\n          'font-size': `${settings.fontSize}%`,\r\n          'font-weight': settings.fontWeight,\r\n          'line-height': settings.lineHeight,\r\n          transform: `scale(${settings.zoom / 100})`,\r\n          'transform-origin': 'top left',\r\n        },\r\n        'a, a:link, a:visited, a:hover, a:active': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n          'text-decoration': 'none',\r\n        },\r\n        '::selection': {\r\n          'background-color': 'rgba(0, 0, 255, 0.1)',\r\n          color: 'inherit',\r\n        },\r\n        '*': {\r\n          transition: 'none !important',\r\n        },\r\n      })\r\n\r\n      rendition.themes.select('default')\r\n\r\n      if (settings.pageView === 'double') {\r\n        rendition.spread('auto')\r\n      } else {\r\n        rendition.spread('none')\r\n      }\r\n    }\r\n  }\r\n\r\n  const updateSettings = (key, value) => {\r\n    setSettings(prevSettings => ({\r\n      ...prevSettings,\r\n      [key]: value,\r\n    }))\r\n  }\r\n\r\n  const handleResetSettings = () => {\r\n    setSettings(defaultSettings)\r\n  }\r\n\r\n  useEffect(() => {\r\n    applySettings()\r\n  }, [settings])\r\n\r\n  useEffect(() => {\r\n    const epubUrl = `https://www.gutenberg.org/cache/epub/${bookId}/pg${bookId}.epub`\r\n    setEpubUrl(epubUrl)\r\n  }, [bookId])\r\n\r\n  useEffect(() => {\r\n    if (rendition) {\r\n      const handleSelection = (cfiRange, contents) => {\r\n        const selection = contents.window.getSelection()\r\n        const range = selection.getRangeAt(0)\r\n        const text = selection.toString().trim()\r\n        if (text) {\r\n          setSelectedText(text)\r\n          setSelectedCfiRange(cfiRange)\r\n          const rect = range.getBoundingClientRect()\r\n          const viewportHeight = window.innerHeight\r\n          const viewportWidth = window.innerWidth\r\n          setPopoverAnchor({\r\n            top:\r\n              rect.top < viewportHeight / 2\r\n                ? rect.bottom + window.scrollY + 115\r\n                : rect.top + window.scrollY - 60,\r\n            left: viewportWidth / 2 + 5,\r\n          })\r\n        }\r\n      }\r\n\r\n      rendition.on('selected', handleSelection)\r\n\r\n      rendition.themes.default({\r\n        '::selection': {\r\n          background: 'rgba(0, 0, 255, 0.1)', // Light blue on selection\r\n          color: 'inherit',\r\n        },\r\n        'a:link': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n        },\r\n        'a:hover': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n        },\r\n      })\r\n\r\n      rendition.on('rendered', section => {\r\n        section.document.addEventListener('click', () => {\r\n          const highlightElements =\r\n            section.document.querySelectorAll('.highlight')\r\n          highlightElements.forEach(el => {\r\n            el.style.transition = 'background-color 0.3s ease'\r\n          })\r\n        })\r\n      })\r\n\r\n      return () => {\r\n        rendition.off('selected', handleSelection)\r\n      }\r\n    }\r\n  }, [rendition])\r\n\r\n  const handleSave = () => {\r\n    if (comment && selectedCfiRange) {\r\n      const newSelection = {\r\n        text: selectedText,\r\n        cfiRange: selectedCfiRange,\r\n        comment,\r\n        color: highlightColor,\r\n        timestamp: Date.now(),\r\n      }\r\n      setSelections(prev => [...prev, newSelection])\r\n\r\n      rendition.annotations.remove(selectedCfiRange, 'highlight')\r\n\r\n      rendition.annotations.add('highlight', selectedCfiRange, {}, null, 'hl', {\r\n        fill: highlightColor,\r\n        'fill-opacity': '0.3',\r\n        'mix-blend-mode': 'multiply',\r\n      })\r\n\r\n      rendition.views().forEach(view => {\r\n        const highlights = view.document.querySelectorAll(\r\n          'mark[data-epubjs-annotation=\"highlight\"]',\r\n        )\r\n        highlights.forEach(highlight => {\r\n          if (highlight.dataset.epubcfi === selectedCfiRange) {\r\n            highlight.style.backgroundColor = highlightColor\r\n            highlight.style.opacity = '0.3'\r\n          }\r\n        })\r\n      })\r\n\r\n      setPopoverAnchor(null)\r\n      setComment('')\r\n      setSelectedText('')\r\n      setSelectedCfiRange('')\r\n    }\r\n  }\r\n\r\n  const handleRemoveHighlight = cfiRange => {\r\n    rendition.annotations.remove(cfiRange, 'highlight')\r\n    setSelections(\r\n      selections.filter(selection => selection.cfiRange !== cfiRange),\r\n    )\r\n  }\r\n\r\n  const filteredSelections = selections\r\n    .filter(selection => {\r\n      const isTextMatch =\r\n        selection.text.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        selection.comment.toLowerCase().includes(searchTerm.toLowerCase())\r\n      const isColorMatch = filter === 'all' || selection.color === filter\r\n      return isTextMatch && isColorMatch\r\n    })\r\n    .sort((a, b) => b.timestamp - a.timestamp)\r\n\r\n  const readerStyles = {\r\n    ...ReactReaderStyle,\r\n    readerArea: {\r\n      ...ReactReaderStyle.readerArea,\r\n      backgroundColor: settings.theme,\r\n      color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\r\n    },\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className='App'\r\n      style={{height: '100vh', display: 'flex', flexDirection: 'column'}}>\r\n      <AppBar position='static'>\r\n        <Toolbar>\r\n          <Button color='inherit' onClick={() => navigate(-1)}>\r\n            <ArrowBack />\r\n            Back\r\n          </Button>\r\n          <Typography variant='h6' style={{flexGrow: 1, textAlign: 'center'}}>\r\n            {bookTitle || 'Epub Reader'}\r\n          </Typography>\r\n          <Button color='inherit' onClick={handleToggleDrawer}>\r\n            <ColorLens />\r\n            Notes\r\n          </Button>\r\n          <Button color='inherit' onClick={handleSettingsDrawerToggle}>\r\n            <Settings />\r\n            Settings\r\n          </Button>\r\n        </Toolbar>\r\n      </AppBar>\r\n      {loading && <p>Loading...</p>}\r\n      {error && <p style={{color: 'red'}}>{error}</p>}\r\n      <div style={{flex: 1, position: 'relative'}} ref={readerRef}>\r\n        <ReactReader\r\n          url={epubUrl}\r\n          epubOptions={{\r\n            allowPopups: true,\r\n            allowScriptedContent: true,\r\n          }}\r\n          location={loca}\r\n          locationChanged={(loc: string) => setLocation(loc)}\r\n          getRendition={_rendition => {\r\n            setRendition(_rendition)\r\n            _rendition.on('started', () => setLoading(false))\r\n          }}\r\n          handleError={handleError}\r\n          readerStyles={readerStyles}\r\n        />\r\n      </div>\r\n      <Popover\r\n        open={Boolean(popoverAnchor)}\r\n        anchorReference='anchorPosition'\r\n        anchorPosition={popoverAnchor}\r\n        onClose={() => setPopoverAnchor(null)}\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'center',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'center',\r\n        }}>\r\n        <div style={{padding: '10px'}}>\r\n          <div style={{display: 'flex', gap: '10px', marginBottom: '10px'}}>\r\n            {colors.map((color, i) => (\r\n              <div\r\n                key={i}\r\n                onClick={() => setHighlightColor(color)}\r\n                style={{\r\n                  width: '20px',\r\n                  height: '20px',\r\n                  backgroundColor: color,\r\n                  border: color === highlightColor ? '2px solid black' : '',\r\n                  cursor: 'pointer',\r\n                }}\r\n              />\r\n            ))}\r\n          </div>\r\n          <TextField\r\n            label='Comment'\r\n            fullWidth\r\n            multiline\r\n            rows={2}\r\n            value={comment}\r\n            onChange={e => setComment(e.target.value)}\r\n            style={{marginBottom: '10px'}}\r\n          />\r\n          <Button\r\n            onClick={handleSave}\r\n            disabled={!comment}\r\n            color='primary'\r\n            variant='contained'>\r\n            Save\r\n          </Button>\r\n        </div>\r\n      </Popover>\r\n      <Drawer anchor='right' open={drawerOpen} onClose={handleToggleDrawer}>\r\n        <div style={{width: 350}}>\r\n          <div\r\n            style={{\r\n              paddingTop: '20px',\r\n              paddingLeft: '20px',\r\n              paddingRight: '20px',\r\n            }}>\r\n            <Typography variant='h6' style={{marginBottom: '10px'}}>\r\n              Notes\r\n            </Typography>\r\n            <TextField\r\n              label='Search Notes'\r\n              value={searchTerm}\r\n              onChange={e => setSearchTerm(e.target.value)}\r\n              fullWidth\r\n              style={{\r\n                marginBottom: '10px',\r\n              }}\r\n            />\r\n            <Select\r\n              value={filter}\r\n              onChange={e => setFilter(e.target.value)}\r\n              fullWidth\r\n              style={{\r\n                marginBottom: '10px',\r\n              }}>\r\n              <MenuItem\r\n                value='all'\r\n                style={{paddingLeft: '20px', paddingRight: '20px'}}>\r\n                All Colors\r\n              </MenuItem>\r\n              {colors.map((color, index) => (\r\n                <MenuItem key={index} value={color}>\r\n                  <span\r\n                    style={{\r\n                      backgroundColor: color,\r\n                      padding: '2px 10px',\r\n                      borderRadius: '5px',\r\n                      color: color,\r\n                    }}>\r\n                    {`ColorColorColorColorColorColori`}\r\n                  </span>\r\n                </MenuItem>\r\n              ))}\r\n            </Select>\r\n          </div>\r\n          <Divider style={{margin: '10px 0'}} />\r\n          <div\r\n            style={{\r\n              maxHeight: 'calc(100vh - 215px)',\r\n              overflowY: 'auto',\r\n              paddingLeft: '20px',\r\n            }}>\r\n            {filteredSelections.map((note, i) => {\r\n              const {text, cfiRange, comment, color, timestamp} = note\r\n              const isLastNote = i === filteredSelections.length - 1\r\n              const isBookmarked = bookmarks.includes(cfiRange)\r\n              return (\r\n                <div\r\n                  key={i}\r\n                  style={{\r\n                    marginBottom: '15px',\r\n                    paddingBottom: '10px',\r\n                    paddingRight: '10px',\r\n                    borderBottom: isLastNote ? 'none' : '1px solid #eee',\r\n                  }}>\r\n                  <div\r\n                    style={{\r\n                      backgroundColor: color,\r\n                      padding: '7px',\r\n                      borderRadius: '5px',\r\n                      marginBottom: '7px',\r\n                    }}>\r\n                    <ExpandableText text={text} maxLength={190} />\r\n                  </div>\r\n                  <ExpandableText text={comment} maxLength={190} />\r\n                  <Typography\r\n                    variant='caption'\r\n                    style={{\r\n                      textAlign: 'right',\r\n                      display: 'block',\r\n                      marginTop: '7px',\r\n                    }}>\r\n                    {new Date(timestamp).toLocaleString()}\r\n                  </Typography>\r\n                  <Button\r\n                    size='small'\r\n                    onClick={() => rendition.display(cfiRange)}\r\n                    style={{marginRight: '5px'}}\r\n                    variant='outlined'>\r\n                    Show\r\n                  </Button>\r\n                  <Button\r\n                    size='small'\r\n                    onClick={() => handleRemoveHighlight(cfiRange)}\r\n                    variant='outlined'\r\n                    color='secondary'\r\n                    style={{marginRight: '80px'}}>\r\n                    Remove\r\n                  </Button>\r\n                  <IconButton\r\n                    size='small'\r\n                    onClick={() => handleEditNote(note)}\r\n                    style={{marginRight: '5px'}}>\r\n                    <Edit />\r\n                  </IconButton>\r\n                  <IconButton\r\n                    size='small'\r\n                    onClick={() => handleToggleBookmark(cfiRange)}>\r\n                    {isBookmarked ? <Bookmark /> : <BookmarkBorder />}\r\n                  </IconButton>\r\n                </div>\r\n              )\r\n            })}\r\n          </div>\r\n        </div>\r\n      </Drawer>\r\n\r\n      <Dialog open={Boolean(editingNote)} onClose={() => setEditingNote(null)}>\r\n        <DialogTitle>Edit Note</DialogTitle>\r\n        <DialogContent>\r\n          <TextField\r\n            autoFocus\r\n            margin='dense'\r\n            label='Comment'\r\n            fullWidth\r\n            multiline\r\n            rows={4}\r\n            value={editingNote?.comment || ''}\r\n            onChange={e =>\r\n              setEditingNote({...editingNote, comment: e.target.value})\r\n            }\r\n          />\r\n          <Select\r\n            value={editingNote?.color || colors[0]}\r\n            onChange={e =>\r\n              setEditingNote({...editingNote, color: e.target.value})\r\n            }\r\n            fullWidth\r\n            style={{marginTop: '10px'}}>\r\n            {colors.map((color, index) => (\r\n              <MenuItem key={index} value={color}>\r\n                <span\r\n                  style={{\r\n                    backgroundColor: color,\r\n                    padding: '2px 10px',\r\n                    borderRadius: '5px',\r\n                    color: color,\r\n                  }}>\r\n                  {`ColorColorColorColorColorColori`}\r\n                </span>\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setEditingNote(null)}>Cancel</Button>\r\n          <Button onClick={handleSaveEdit}>Save</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <Drawer\r\n        anchor='right'\r\n        open={settingsDrawerOpen}\r\n        onClose={handleSettingsDrawerToggle}>\r\n        <div\r\n          style={{\r\n            width: 350,\r\n            paddingTop: 15,\r\n            paddingLeft: 25,\r\n            paddingRight: 25,\r\n          }}>\r\n          <Typography variant='h6' gutterBottom style={{marginBottom: -5}}>\r\n            Settings\r\n          </Typography>\r\n          <FormControl fullWidth margin='normal'>\r\n            <Typography gutterBottom>Theme</Typography>\r\n            <Select\r\n              value={settings.theme}\r\n              onChange={e => updateSettings('theme', e.target.value)}>\r\n              {themes.map((t, index) => (\r\n                <MenuItem key={index} value={t}>\r\n                  <div\r\n                    style={{\r\n                      width: 20,\r\n                      height: 20,\r\n                      backgroundColor: t,\r\n                      border: '1px solid #000',\r\n                      display: 'inline-block',\r\n                      marginRight: 10,\r\n                      marginBottom: -5,\r\n                    }}\r\n                  />\r\n                  {t === '#FFFFFF'\r\n                    ? 'White'\r\n                    : t === '#F5F5F5'\r\n                    ? 'Light Gray'\r\n                    : t === '#E0E0E0'\r\n                    ? 'Gray'\r\n                    : 'Dark'}\r\n                </MenuItem>\r\n              ))}\r\n            </Select>\r\n          </FormControl>\r\n          <FormControl fullWidth margin='normal'>\r\n            <Typography gutterBottom style={{marginBottom: -5}}>\r\n              Page View\r\n            </Typography>\r\n            <RadioGroup\r\n              row\r\n              value={settings.pageView}\r\n              style={{marginBottom: -10}}\r\n              onChange={e => updateSettings('pageView', e.target.value)}>\r\n              <FormControlLabel\r\n                value='single'\r\n                control={<Radio />}\r\n                label='Single'\r\n              />\r\n              <FormControlLabel\r\n                value='double'\r\n                control={<Radio />}\r\n                label='Double'\r\n              />\r\n            </RadioGroup>\r\n          </FormControl>\r\n          <FormControl fullWidth margin='normal'>\r\n            <Typography gutterBottom>Font Family</Typography>\r\n            <Select\r\n              value={settings.fontFamily}\r\n              onChange={e => updateSettings('fontFamily', e.target.value)}>\r\n              {fontFamilies.map((font, index) => (\r\n                <MenuItem key={index} value={font} style={{fontFamily: font}}>\r\n                  {font}\r\n                </MenuItem>\r\n              ))}\r\n            </Select>\r\n          </FormControl>\r\n          <FormControl fullWidth margin='normal'>\r\n            <Typography gutterBottom>\r\n              Font Size: {settings.fontSize}%\r\n            </Typography>\r\n            <Slider\r\n              value={settings.fontSize}\r\n              onChange={(_, newValue) => updateSettings('fontSize', newValue)}\r\n              min={50}\r\n              max={200}\r\n              step={10}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth margin='normal'>\r\n            <Typography gutterBottom>\r\n              Font Weight: {settings.fontWeight}\r\n            </Typography>\r\n            <Slider\r\n              value={settings.fontWeight}\r\n              onChange={(_, newValue) => updateSettings('fontWeight', newValue)}\r\n              min={100}\r\n              max={900}\r\n              step={100}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth margin='normal'>\r\n            <Typography gutterBottom>\r\n              Line Height: {settings.lineHeight}\r\n            </Typography>\r\n            <Slider\r\n              value={settings.lineHeight}\r\n              onChange={(_, newValue) => updateSettings('lineHeight', newValue)}\r\n              min={1}\r\n              max={3}\r\n              step={0.1}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth margin='normal'>\r\n            <Typography gutterBottom>Zoom: {settings.zoom}%</Typography>\r\n            <Slider\r\n              value={settings.zoom}\r\n              onChange={(_, newValue) => updateSettings('zoom', newValue)}\r\n              min={50}\r\n              max={200}\r\n              step={10}\r\n            />\r\n          </FormControl>\r\n          <Button\r\n            variant='contained'\r\n            color='secondary'\r\n            fullWidth\r\n            onClick={handleResetSettings}\r\n            style={{marginTop: 5}}>\r\n            Reset Settings\r\n          </Button>\r\n        </div>\r\n      </Drawer>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ReadBookScreen\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}