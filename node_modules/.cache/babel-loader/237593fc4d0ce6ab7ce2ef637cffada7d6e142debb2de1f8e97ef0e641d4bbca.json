{"ast":null,"code":"import React,{useState}from'react';import{Typography,Box,IconButton,Tooltip}from'@mui/material';import{Star,ThumbsUp,Flag}from'lucide-react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReviewItem=_ref=>{let{review,index,isLast,currentUser}=_ref;const[isLiked,setIsLiked]=useState(review.liked);const[isReported,setIsReported]=useState(review.reported);const[likeCount,setLikeCount]=useState(review.likeCount);const isOwnReview=currentUser&&currentUser.userId===review.userId;const handleLike=async()=>{if(isOwnReview)return;try{await axios.post(`http://localhost:8080/api/v1/review/${review.reviewId}/like/user/${currentUser.userId}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});if(isLiked){setLikeCount(prev=>prev-1);}else{setLikeCount(prev=>prev+1);}setIsLiked(!isLiked);}catch(error){console.error('Error liking review:',error);}};const handleReport=async()=>{if(isOwnReview)return;try{await axios.post(`http://localhost:8080/api/v1/review/${review.reviewId}/report/user/${currentUser.userId}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});setIsReported(true);}catch(error){console.error('Error reporting review:',error);}};return/*#__PURE__*/_jsxs(Box,{sx:{mb:1,pb:!isLast?1:0,borderBottom:!isLast?'1px solid':'none',borderColor:'divider'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",fontWeight:\"bold\",children:review.fullname}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:new Date(review.createdAt).toLocaleDateString()})]}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',alignItems:'center',gap:0.5,mb:1},children:[1,2,3,4,5].map(star=>/*#__PURE__*/_jsx(Star,{size:16,className:star<=review.rating?'text-yellow-400 fill-yellow-400':'text-gray-300'},star))}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mb:2},children:review.review}),currentUser&&/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Tooltip,{title:isOwnReview?'You cannot like your own review':isLiked?'Unlike':'Like',children:/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:handleLike,color:isLiked?'primary':'default',disabled:isOwnReview,children:/*#__PURE__*/_jsx(ThumbsUp,{size:18,className:isLiked?'fill-current':''})})})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:isLiked?'primary':'text.secondary',children:likeCount})]}),!isOwnReview&&/*#__PURE__*/_jsx(Tooltip,{title:isReported?'Reported':'Report',children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:handleReport,color:isReported?'error':'default',disabled:isReported,children:/*#__PURE__*/_jsx(Flag,{size:18,className:isReported?'fill-current':''})})})]})]});};export default ReviewItem;","map":{"version":3,"names":["React","useState","Typography","Box","IconButton","Tooltip","Star","ThumbsUp","Flag","axios","jsx","_jsx","jsxs","_jsxs","ReviewItem","_ref","review","index","isLast","currentUser","isLiked","setIsLiked","liked","isReported","setIsReported","reported","likeCount","setLikeCount","isOwnReview","userId","handleLike","post","reviewId","headers","Authorization","localStorage","getItem","prev","error","console","handleReport","sx","mb","pb","borderBottom","borderColor","children","display","justifyContent","variant","fontWeight","fullname","color","Date","createdAt","toLocaleDateString","alignItems","gap","map","star","size","className","rating","title","onClick","disabled"],"sources":["C:/Users/TTC/OneDrive/Documents/GITHUB/fe-readhub/src/pages/description_book/views/ReviewItem.js"],"sourcesContent":["import React, {useState} from 'react'\r\nimport {Typography, Box, IconButton, Tooltip} from '@mui/material'\r\nimport {Star, ThumbsUp, Flag} from 'lucide-react'\r\nimport axios from 'axios'\r\n\r\nconst ReviewItem = ({review, index, isLast, currentUser}) => {\r\n  const [isLiked, setIsLiked] = useState(review.liked)\r\n  const [isReported, setIsReported] = useState(review.reported)\r\n  const [likeCount, setLikeCount] = useState(review.likeCount)\r\n\r\n  const isOwnReview = currentUser && currentUser.userId === review.userId\r\n\r\n  const handleLike = async () => {\r\n    if (isOwnReview) return\r\n    try {\r\n      await axios.post(\r\n        `http://localhost:8080/api/v1/review/${review.reviewId}/like/user/${currentUser.userId}`,\r\n        {},\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n\r\n      if (isLiked) {\r\n        setLikeCount(prev => prev - 1)\r\n      } else {\r\n        setLikeCount(prev => prev + 1)\r\n      }\r\n      setIsLiked(!isLiked)\r\n    } catch (error) {\r\n      console.error('Error liking review:', error)\r\n    }\r\n  }\r\n\r\n  const handleReport = async () => {\r\n    if (isOwnReview) return\r\n    try {\r\n      await axios.post(\r\n        `http://localhost:8080/api/v1/review/${review.reviewId}/report/user/${currentUser.userId}`,\r\n        {},\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n      setIsReported(true)\r\n    } catch (error) {\r\n      console.error('Error reporting review:', error)\r\n    }\r\n  }\r\n  return (\r\n    <Box\r\n      sx={{\r\n        mb: 1,\r\n        pb: !isLast ? 1 : 0,\r\n        borderBottom: !isLast ? '1px solid' : 'none',\r\n        borderColor: 'divider',\r\n      }}>\r\n      <Box sx={{display: 'flex', justifyContent: 'space-between', mb: 1}}>\r\n        <Typography variant='subtitle1' fontWeight='bold'>\r\n          {review.fullname}\r\n        </Typography>\r\n        <Typography variant='body2' color='text.secondary'>\r\n          {new Date(review.createdAt).toLocaleDateString()}\r\n        </Typography>\r\n      </Box>\r\n\r\n      <Box sx={{display: 'flex', alignItems: 'center', gap: 0.5, mb: 1}}>\r\n        {[1, 2, 3, 4, 5].map(star => (\r\n          <Star\r\n            key={star}\r\n            size={16}\r\n            className={\r\n              star <= review.rating\r\n                ? 'text-yellow-400 fill-yellow-400'\r\n                : 'text-gray-300'\r\n            }\r\n          />\r\n        ))}\r\n      </Box>\r\n\r\n      <Typography variant='body1' sx={{mb: 2}}>\r\n        {review.review}\r\n      </Typography>\r\n\r\n      {currentUser && (\r\n        <Box sx={{display: 'flex', alignItems: 'center', gap: 2}}>\r\n          <Box sx={{display: 'flex', alignItems: 'center', gap: 1}}>\r\n            <Tooltip\r\n              title={\r\n                isOwnReview\r\n                  ? 'You cannot like your own review'\r\n                  : isLiked\r\n                  ? 'Unlike'\r\n                  : 'Like'\r\n              }>\r\n              <span>\r\n                <IconButton\r\n                  size='small'\r\n                  onClick={handleLike}\r\n                  color={isLiked ? 'primary' : 'default'}\r\n                  disabled={isOwnReview}>\r\n                  <ThumbsUp\r\n                    size={18}\r\n                    className={isLiked ? 'fill-current' : ''}\r\n                  />\r\n                </IconButton>\r\n              </span>\r\n            </Tooltip>\r\n            <Typography\r\n              variant='body2'\r\n              color={isLiked ? 'primary' : 'text.secondary'}>\r\n              {likeCount}\r\n            </Typography>\r\n          </Box>\r\n\r\n          {!isOwnReview && (\r\n            <Tooltip title={isReported ? 'Reported' : 'Report'}>\r\n              <IconButton\r\n                size='small'\r\n                onClick={handleReport}\r\n                color={isReported ? 'error' : 'default'}\r\n                disabled={isReported}>\r\n                <Flag size={18} className={isReported ? 'fill-current' : ''} />\r\n              </IconButton>\r\n            </Tooltip>\r\n          )}\r\n        </Box>\r\n      )}\r\n    </Box>\r\n  )\r\n}\r\n\r\nexport default ReviewItem\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}