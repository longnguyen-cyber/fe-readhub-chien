{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TTC\\\\OneDrive\\\\Documents\\\\GITHUB\\\\fe-readhub\\\\src\\\\pages\\\\read_book\\\\views\\\\ReadBookScreen.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { ReactReaderStyle } from 'react-reader';\nimport ePub from 'epubjs';\nimport ReaderHeader from './ReaderHeader';\nimport ReaderContent from './ReaderContent';\nimport NotePopover from './NotePopover';\nimport NotesDrawer from './NotesDrawer';\nimport SettingsDrawer from './SettingsDrawer';\nimport { Button, Select, MenuItem, TextField, DialogActions, Dialog, DialogTitle, DialogContent } from '@mui/material';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst colors = ['#FFB3BA', '#FFDFBA', '#FFFFBA', '#BAFFC9', '#BAE1FF'];\nconst themes = ['#FFFFFF', '#F5F5F5', '#121212'];\nconst fontFamilies = ['Arial', 'Times New Roman', 'Georgia', 'Verdana', 'Roboto'];\nconst defaultSettings = {\n  theme: themes[0],\n  pageView: 'double',\n  fontFamily: fontFamilies[0],\n  fontSize: 100,\n  fontWeight: 400,\n  lineHeight: 1.5,\n  zoom: 100\n};\nfunction ReadBookScreen() {\n  _s();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loca, setLocation] = useState(location || '');\n  const {\n    bookId,\n    bookTitle\n  } = location.state || {};\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [epubUrl, setEpubUrl] = useState(null);\n  const [selections, setSelections] = useState([]);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const [rendition, setRendition] = useState(null);\n  const [highlightColor, setHighlightColor] = useState(colors[0]);\n  const [comment, setComment] = useState('');\n  const [popoverAnchor, setPopoverAnchor] = useState(null);\n  const [selectedText, setSelectedText] = useState('');\n  const [selectedCfiRange, setSelectedCfiRange] = useState('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filter, setFilter] = useState('all');\n  const [editingNote, setEditingNote] = useState(null);\n  const [bookmarks, setBookmarks] = useState([]);\n  const [settingsDrawerOpen, setSettingsDrawerOpen] = useState(false);\n  const [settings, setSettings] = useState(defaultSettings);\n  const [user, setUser] = useState(null);\n  const [isNote, setIsNote] = useState(false);\n  const getUser = async () => {\n    try {\n      const response = await axios.get('http://localhost:8080/api/v1/user/profile', {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setUser(response.data);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  const getNotes = async () => {\n    if (!user || !bookId) return;\n    try {\n      const response = await axios.get(`http://localhost:8080/api/v1/note/user/${user.userId}/book/${bookId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n\n      // Extract the data array from the response\n      const notesData = Array.isArray(response.data.data) ? response.data.data : [];\n      setSelections(notesData);\n      if (rendition) {\n        notesData.forEach(note => {\n          rendition.annotations.add('highlight', note.cfiRange, {}, null, 'hl', {\n            fill: note.color,\n            'fill-opacity': '0.3',\n            'mix-blend-mode': 'multiply'\n          });\n        });\n      }\n    } catch (error) {\n      console.error('Error fetching notes:', error);\n      setSelections([]); // Set to empty array in case of error\n    }\n  };\n  const handleEditNote = note => {\n    setEditingNote(note);\n    console.log('note', note);\n  };\n  const handleSaveEdit = async () => {\n    try {\n      await axios.put(`http://localhost:8080/api/v1/note`, editingNote, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      if (editingNote) {\n        setSelections(selections.map(s => s.cfiRange === editingNote.cfiRange ? editingNote : s));\n        setEditingNote(null);\n      }\n      setIsNote(!isNote);\n    } catch (error) {\n      console.error('Error updating note:', error);\n    }\n  };\n  const handleToggleBookmark = cfiRange => {\n    if (bookmarks.includes(cfiRange)) {\n      setBookmarks(bookmarks.filter(b => b !== cfiRange));\n    } else {\n      setBookmarks([...bookmarks, cfiRange]);\n    }\n  };\n  const handleError = error => {\n    console.error('Error in ReactReader:', error);\n    setError('An error occurred while loading the book. Please try again later.');\n    setLoading(false);\n  };\n  const handleToggleDrawer = () => {\n    setDrawerOpen(!drawerOpen);\n  };\n  const handleSettingsDrawerToggle = () => {\n    setSettingsDrawerOpen(!settingsDrawerOpen);\n  };\n  const applySettings = () => {\n    if (rendition) {\n      rendition.themes.default({\n        body: {\n          background: settings.theme,\n          color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\n          'font-family': settings.fontFamily,\n          'font-size': `${settings.fontSize}%`,\n          'font-weight': settings.fontWeight,\n          'line-height': settings.lineHeight,\n          transform: `scale(${settings.zoom / 100})`,\n          'transform-origin': 'top left'\n        },\n        'a, a:link, a:visited, a:hover, a:active': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important',\n          'text-decoration': 'none'\n        },\n        '::selection': {\n          'background-color': 'rgba(0, 0, 255, 0.1)',\n          color: 'inherit'\n        },\n        '*': {\n          transition: 'none !important'\n        }\n      });\n      rendition.themes.select('default');\n      if (settings.pageView === 'double') {\n        rendition.spread('auto');\n      } else {\n        rendition.spread('none');\n      }\n    }\n  };\n  const updateSettings = (key, value) => {\n    setSettings(prevSettings => ({\n      ...prevSettings,\n      [key]: value\n    }));\n  };\n  const handleResetSettings = () => {\n    setSettings(defaultSettings);\n  };\n  useEffect(() => {\n    applySettings();\n  }, [settings]);\n  useEffect(() => {\n    const epubUrl = `https://www.gutenberg.org/cache/epub/${bookId}/pg${bookId}.epub`;\n    setEpubUrl(epubUrl);\n    getUser();\n  }, [bookId]);\n  useEffect(() => {\n    if (user && bookId) {\n      getNotes();\n    }\n  }, [user, bookId, rendition, isNote]);\n  useEffect(() => {\n    if (rendition) {\n      const handleSelection = (cfiRange, contents) => {\n        const selection = contents.window.getSelection();\n        const range = selection.getRangeAt(0);\n        const text = selection.toString().trim();\n        if (text) {\n          setSelectedText(text);\n          setSelectedCfiRange(cfiRange);\n          const rect = range.getBoundingClientRect();\n          const viewportHeight = window.innerHeight;\n          const viewportWidth = window.innerWidth;\n          setPopoverAnchor({\n            top: rect.top < viewportHeight / 2 ? rect.bottom + window.scrollY + 115 : rect.top + window.scrollY - 60,\n            left: viewportWidth / 2 + 5\n          });\n        }\n      };\n      rendition.on('selected', handleSelection);\n      rendition.themes.default({\n        '::selection': {\n          background: 'rgba(0, 0, 255, 0.1)',\n          // Light blue on selection\n          color: 'inherit'\n        },\n        'a:link': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important'\n        },\n        'a:hover': {\n          color: 'inherit !important',\n          '-webkit-text-fill-color': 'inherit !important'\n        }\n      });\n      rendition.on('rendered', section => {\n        section.document.addEventListener('click', () => {\n          const highlightElements = section.document.querySelectorAll('.highlight');\n          highlightElements.forEach(el => {\n            el.style.transition = 'background-color 0.3s ease';\n          });\n        });\n      });\n      return () => {\n        rendition.off('selected', handleSelection);\n      };\n    }\n  }, [rendition]);\n  useEffect(() => {\n    if (rendition) {\n      const applyHighlights = () => {\n        rendition.views().forEach(view => {\n          selections.forEach(note => {\n            try {\n              const cfiRange = new ePub.CFI(note.cfiRange);\n              const range = cfiRange.toRange(view.document);\n              if (range) {\n                const newHighlight = view.document.createElement('div');\n                newHighlight.setAttribute('style', `\n                background-color: ${note.color};\n                opacity: 0.3;\n                position: absolute;\n                z-index: -1;\n                pointer-events: none;\n                `);\n                const rects = range.getClientRects();\n                for (let i = 0; i < rects.length; i++) {\n                  const rect = rects[i];\n                  const highlightClone = newHighlight.cloneNode();\n                  highlightClone.style.left = `${rect.left}px`;\n                  highlightClone.style.top = `${rect.top}px`;\n                  highlightClone.style.height = `${rect.height}px`;\n                  highlightClone.style.width = `${rect.width}px`;\n                  view.document.body.appendChild(highlightClone);\n                }\n              }\n            } catch (error) {\n              console.error('Error applying highlight:', error);\n            }\n          });\n        });\n      };\n      rendition.on('rendered', section => {\n        applyHighlights();\n      });\n      rendition.on('relocated', location => {\n        applyHighlights();\n      });\n    }\n  }, [rendition, selections]);\n  const handleSave = async () => {\n    if (comment && selectedCfiRange) {\n      const newNote = {\n        userId: user.userId,\n        bookId: bookId,\n        content: comment,\n        selectedText: selectedText,\n        cfiRange: selectedCfiRange,\n        color: highlightColor\n      };\n      try {\n        const response = await axios.post('http://localhost:8080/api/v1/note', newNote, {\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        const createdNote = response.data;\n        setSelections(prev => [...prev, createdNote]);\n        setIsNote(!isNote);\n        rendition.annotations.add('highlight', selectedCfiRange, {}, null, 'hl', {\n          fill: highlightColor,\n          'fill-opacity': '0.3',\n          'mix-blend-mode': 'multiply'\n        });\n        rendition.views().forEach(view => {\n          const highlights = view.document.querySelectorAll('mark[data-epubjs-annotation=\"highlight\"]');\n          highlights.forEach(highlight => {\n            if (highlight.dataset.epubcfi === selectedCfiRange) {\n              highlight.style.backgroundColor = highlightColor;\n              highlight.style.opacity = '0.3';\n            }\n          });\n        });\n        setPopoverAnchor(null);\n        setComment('');\n        setSelectedText('');\n        setSelectedCfiRange('');\n      } catch (error) {\n        console.error('Error creating note:', error);\n      }\n    }\n  };\n  const handleRemoveHighlight = async (cfiRange, noteId) => {\n    try {\n      await axios.delete(`http://localhost:8080/api/v1/note/${noteId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setSelections(selections.filter(s => s.cfiRange !== cfiRange));\n      rendition.annotations.remove(cfiRange);\n    } catch (error) {\n      console.error('Error deleting note:', error);\n    }\n  };\n  const filteredSelections = Array.isArray(selections) ? selections.filter(selection => {\n    var _selection$selectedTe, _selection$selectedTe2, _selection$content$to, _selection$content;\n    const isTextMatch = ((_selection$selectedTe = (_selection$selectedTe2 = selection.selectedText) === null || _selection$selectedTe2 === void 0 ? void 0 : _selection$selectedTe2.toLowerCase().includes(searchTerm.toLowerCase())) !== null && _selection$selectedTe !== void 0 ? _selection$selectedTe : false) || ((_selection$content$to = (_selection$content = selection.content) === null || _selection$content === void 0 ? void 0 : _selection$content.toLowerCase().includes(searchTerm.toLowerCase())) !== null && _selection$content$to !== void 0 ? _selection$content$to : false);\n    const isColorMatch = filter === 'all' || selection.color === filter;\n    return isTextMatch && isColorMatch;\n  }).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)) // Sắp xếp theo thời gian, mới nhất trước\n  : [];\n  const readerStyles = {\n    ...ReactReaderStyle,\n    readerArea: {\n      ...ReactReaderStyle.readerArea,\n      backgroundColor: settings.theme,\n      color: settings.theme === '#121212' ? '#FFFFFF' : '#000000'\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    style: {\n      height: '100vh',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    children: [/*#__PURE__*/_jsxDEV(ReaderHeader, {\n      title: bookTitle,\n      onBack: () => navigate(-1),\n      onToggleNotes: handleToggleDrawer,\n      onToggleSettings: handleSettingsDrawerToggle,\n      user: user\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 19\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(ReaderContent, {\n      epubUrl: epubUrl,\n      location: loca,\n      onLocationChanged: loc => setLocation(loc),\n      onGetRendition: _rendition => {\n        setRendition(_rendition);\n        _rendition.on('started', () => setLoading(false));\n      },\n      onError: handleError,\n      readerStyles: readerStyles\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(NotePopover, {\n      anchorPosition: popoverAnchor,\n      open: Boolean(popoverAnchor),\n      onClose: () => setPopoverAnchor(null),\n      colors: colors,\n      highlightColor: highlightColor,\n      setHighlightColor: setHighlightColor,\n      comment: comment,\n      setComment: setComment,\n      onSave: handleSave\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 468,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(NotesDrawer, {\n      open: drawerOpen,\n      onClose: handleToggleDrawer,\n      searchTerm: searchTerm,\n      setSearchTerm: setSearchTerm,\n      filter: filter,\n      setFilter: setFilter,\n      colors: colors,\n      filteredSelections: filteredSelections,\n      rendition: rendition,\n      onRemoveHighlight: handleRemoveHighlight,\n      onEditNote: handleEditNote,\n      bookmarks: bookmarks,\n      onToggleBookmark: handleToggleBookmark\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: Boolean(editingNote),\n      onClose: () => setEditingNote(null),\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Edit Note\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          autoFocus: true,\n          margin: \"dense\",\n          label: \"Comment\",\n          fullWidth: true,\n          multiline: true,\n          rows: 4,\n          value: (editingNote === null || editingNote === void 0 ? void 0 : editingNote.content) || '',\n          onChange: e => setEditingNote({\n            ...editingNote,\n            content: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          value: (editingNote === null || editingNote === void 0 ? void 0 : editingNote.color) || colors[0],\n          onChange: e => setEditingNote({\n            ...editingNote,\n            color: e.target.value\n          }),\n          fullWidth: true,\n          style: {\n            marginTop: '10px'\n          },\n          children: colors.map((color, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: color,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                backgroundColor: color,\n                padding: '2px 10px',\n                borderRadius: '5px',\n                color: color\n              },\n              children: `ColorColorColorColorColorColori`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setEditingNote(null),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSaveEdit,\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 532,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 495,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SettingsDrawer, {\n      open: settingsDrawerOpen,\n      onClose: handleSettingsDrawerToggle,\n      settings: settings,\n      updateSettings: updateSettings,\n      themes: themes,\n      fontFamilies: fontFamilies,\n      onResetSettings: handleResetSettings\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 537,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 445,\n    columnNumber: 5\n  }, this);\n}\n_s(ReadBookScreen, \"5fxraynnHBtE8Ylmg4gM+qF6cY0=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = ReadBookScreen;\nexport default ReadBookScreen;\nvar _c;\n$RefreshReg$(_c, \"ReadBookScreen\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","ReactReaderStyle","ePub","ReaderHeader","ReaderContent","NotePopover","NotesDrawer","SettingsDrawer","Button","Select","MenuItem","TextField","DialogActions","Dialog","DialogTitle","DialogContent","axios","jsxDEV","_jsxDEV","colors","themes","fontFamilies","defaultSettings","theme","pageView","fontFamily","fontSize","fontWeight","lineHeight","zoom","ReadBookScreen","_s","navigate","location","loca","setLocation","bookId","bookTitle","state","error","setError","loading","setLoading","epubUrl","setEpubUrl","selections","setSelections","drawerOpen","setDrawerOpen","rendition","setRendition","highlightColor","setHighlightColor","comment","setComment","popoverAnchor","setPopoverAnchor","selectedText","setSelectedText","selectedCfiRange","setSelectedCfiRange","searchTerm","setSearchTerm","filter","setFilter","editingNote","setEditingNote","bookmarks","setBookmarks","settingsDrawerOpen","setSettingsDrawerOpen","settings","setSettings","user","setUser","isNote","setIsNote","getUser","response","get","headers","Authorization","localStorage","getItem","data","console","getNotes","userId","notesData","Array","isArray","forEach","note","annotations","add","cfiRange","fill","color","handleEditNote","log","handleSaveEdit","put","map","s","handleToggleBookmark","includes","b","handleError","handleToggleDrawer","handleSettingsDrawerToggle","applySettings","default","body","background","transform","transition","select","spread","updateSettings","key","value","prevSettings","handleResetSettings","handleSelection","contents","selection","window","getSelection","range","getRangeAt","text","toString","trim","rect","getBoundingClientRect","viewportHeight","innerHeight","viewportWidth","innerWidth","top","bottom","scrollY","left","on","section","document","addEventListener","highlightElements","querySelectorAll","el","style","off","applyHighlights","views","view","CFI","toRange","newHighlight","createElement","setAttribute","rects","getClientRects","i","length","highlightClone","cloneNode","height","width","appendChild","handleSave","newNote","content","post","createdNote","prev","highlights","highlight","dataset","epubcfi","backgroundColor","opacity","handleRemoveHighlight","noteId","delete","remove","filteredSelections","_selection$selectedTe","_selection$selectedTe2","_selection$content$to","_selection$content","isTextMatch","toLowerCase","isColorMatch","sort","a","Date","createdAt","readerStyles","readerArea","className","display","flexDirection","children","title","onBack","onToggleNotes","onToggleSettings","fileName","_jsxFileName","lineNumber","columnNumber","onLocationChanged","loc","onGetRendition","_rendition","onError","anchorPosition","open","Boolean","onClose","onSave","onRemoveHighlight","onEditNote","onToggleBookmark","autoFocus","margin","label","fullWidth","multiline","rows","onChange","e","target","marginTop","index","padding","borderRadius","onClick","onResetSettings","_c","$RefreshReg$"],"sources":["C:/Users/TTC/OneDrive/Documents/GITHUB/fe-readhub/src/pages/read_book/views/ReadBookScreen.js"],"sourcesContent":["import React, {useEffect, useState} from 'react'\r\nimport {useLocation, useNavigate} from 'react-router-dom'\r\nimport {ReactReaderStyle} from 'react-reader'\r\nimport ePub from 'epubjs'\r\nimport ReaderHeader from './ReaderHeader'\r\nimport ReaderContent from './ReaderContent'\r\nimport NotePopover from './NotePopover'\r\nimport NotesDrawer from './NotesDrawer'\r\nimport SettingsDrawer from './SettingsDrawer'\r\nimport {\r\n  Button,\r\n  Select,\r\n  MenuItem,\r\n  TextField,\r\n  DialogActions,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n} from '@mui/material'\r\nimport axios from 'axios'\r\n\r\nconst colors = ['#FFB3BA', '#FFDFBA', '#FFFFBA', '#BAFFC9', '#BAE1FF']\r\nconst themes = ['#FFFFFF', '#F5F5F5', '#121212']\r\nconst fontFamilies = [\r\n  'Arial',\r\n  'Times New Roman',\r\n  'Georgia',\r\n  'Verdana',\r\n  'Roboto',\r\n]\r\nconst defaultSettings = {\r\n  theme: themes[0],\r\n  pageView: 'double',\r\n  fontFamily: fontFamilies[0],\r\n  fontSize: 100,\r\n  fontWeight: 400,\r\n  lineHeight: 1.5,\r\n  zoom: 100,\r\n}\r\n\r\nfunction ReadBookScreen() {\r\n  const navigate = useNavigate()\r\n  const location = useLocation()\r\n  const [loca, setLocation] = useState(location || '')\r\n  const {bookId, bookTitle} = location.state || {}\r\n  const [error, setError] = useState(null)\r\n  const [loading, setLoading] = useState(false)\r\n  const [epubUrl, setEpubUrl] = useState(null)\r\n  const [selections, setSelections] = useState([])\r\n  const [drawerOpen, setDrawerOpen] = useState(false)\r\n  const [rendition, setRendition] = useState(null)\r\n  const [highlightColor, setHighlightColor] = useState(colors[0])\r\n  const [comment, setComment] = useState('')\r\n  const [popoverAnchor, setPopoverAnchor] = useState(null)\r\n  const [selectedText, setSelectedText] = useState('')\r\n  const [selectedCfiRange, setSelectedCfiRange] = useState('')\r\n  const [searchTerm, setSearchTerm] = useState('')\r\n  const [filter, setFilter] = useState('all')\r\n  const [editingNote, setEditingNote] = useState(null)\r\n  const [bookmarks, setBookmarks] = useState([])\r\n  const [settingsDrawerOpen, setSettingsDrawerOpen] = useState(false)\r\n  const [settings, setSettings] = useState(defaultSettings)\r\n  const [user, setUser] = useState(null)\r\n  const [isNote, setIsNote] = useState(false)\r\n\r\n  const getUser = async () => {\r\n    try {\r\n      const response = await axios.get(\r\n        'http://localhost:8080/api/v1/user/profile',\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n      setUser(response.data)\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  const getNotes = async () => {\r\n    if (!user || !bookId) return\r\n\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:8080/api/v1/note/user/${user.userId}/book/${bookId}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        },\r\n      )\r\n\r\n      // Extract the data array from the response\r\n      const notesData = Array.isArray(response.data.data)\r\n        ? response.data.data\r\n        : []\r\n      setSelections(notesData)\r\n\r\n      if (rendition) {\r\n        notesData.forEach(note => {\r\n          rendition.annotations.add(\r\n            'highlight',\r\n            note.cfiRange,\r\n            {},\r\n            null,\r\n            'hl',\r\n            {\r\n              fill: note.color,\r\n              'fill-opacity': '0.3',\r\n              'mix-blend-mode': 'multiply',\r\n            },\r\n          )\r\n        })\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching notes:', error)\r\n      setSelections([]) // Set to empty array in case of error\r\n    }\r\n  }\r\n\r\n  const handleEditNote = note => {\r\n    setEditingNote(note)\r\n    console.log('note', note)\r\n  }\r\n  const handleSaveEdit = async () => {\r\n    try {\r\n      await axios.put(`http://localhost:8080/api/v1/note`, editingNote, {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      })\r\n      if (editingNote) {\r\n        setSelections(\r\n          selections.map(s =>\r\n            s.cfiRange === editingNote.cfiRange ? editingNote : s,\r\n          ),\r\n        )\r\n        setEditingNote(null)\r\n      }\r\n      setIsNote(!isNote)\r\n    } catch (error) {\r\n      console.error('Error updating note:', error)\r\n    }\r\n  }\r\n\r\n  const handleToggleBookmark = cfiRange => {\r\n    if (bookmarks.includes(cfiRange)) {\r\n      setBookmarks(bookmarks.filter(b => b !== cfiRange))\r\n    } else {\r\n      setBookmarks([...bookmarks, cfiRange])\r\n    }\r\n  }\r\n\r\n  const handleError = error => {\r\n    console.error('Error in ReactReader:', error)\r\n    setError(\r\n      'An error occurred while loading the book. Please try again later.',\r\n    )\r\n    setLoading(false)\r\n  }\r\n\r\n  const handleToggleDrawer = () => {\r\n    setDrawerOpen(!drawerOpen)\r\n  }\r\n  const handleSettingsDrawerToggle = () => {\r\n    setSettingsDrawerOpen(!settingsDrawerOpen)\r\n  }\r\n\r\n  const applySettings = () => {\r\n    if (rendition) {\r\n      rendition.themes.default({\r\n        body: {\r\n          background: settings.theme,\r\n          color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\r\n          'font-family': settings.fontFamily,\r\n          'font-size': `${settings.fontSize}%`,\r\n          'font-weight': settings.fontWeight,\r\n          'line-height': settings.lineHeight,\r\n          transform: `scale(${settings.zoom / 100})`,\r\n          'transform-origin': 'top left',\r\n        },\r\n        'a, a:link, a:visited, a:hover, a:active': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n          'text-decoration': 'none',\r\n        },\r\n        '::selection': {\r\n          'background-color': 'rgba(0, 0, 255, 0.1)',\r\n          color: 'inherit',\r\n        },\r\n        '*': {\r\n          transition: 'none !important',\r\n        },\r\n      })\r\n\r\n      rendition.themes.select('default')\r\n\r\n      if (settings.pageView === 'double') {\r\n        rendition.spread('auto')\r\n      } else {\r\n        rendition.spread('none')\r\n      }\r\n    }\r\n  }\r\n\r\n  const updateSettings = (key, value) => {\r\n    setSettings(prevSettings => ({\r\n      ...prevSettings,\r\n      [key]: value,\r\n    }))\r\n  }\r\n\r\n  const handleResetSettings = () => {\r\n    setSettings(defaultSettings)\r\n  }\r\n\r\n  useEffect(() => {\r\n    applySettings()\r\n  }, [settings])\r\n\r\n  useEffect(() => {\r\n    const epubUrl = `https://www.gutenberg.org/cache/epub/${bookId}/pg${bookId}.epub`\r\n    setEpubUrl(epubUrl)\r\n    getUser()\r\n  }, [bookId])\r\n\r\n  useEffect(() => {\r\n    if (user && bookId) {\r\n      getNotes()\r\n    }\r\n  }, [user, bookId, rendition, isNote])\r\n\r\n  useEffect(() => {\r\n    if (rendition) {\r\n      const handleSelection = (cfiRange, contents) => {\r\n        const selection = contents.window.getSelection()\r\n        const range = selection.getRangeAt(0)\r\n        const text = selection.toString().trim()\r\n        if (text) {\r\n          setSelectedText(text)\r\n          setSelectedCfiRange(cfiRange)\r\n          const rect = range.getBoundingClientRect()\r\n          const viewportHeight = window.innerHeight\r\n          const viewportWidth = window.innerWidth\r\n          setPopoverAnchor({\r\n            top:\r\n              rect.top < viewportHeight / 2\r\n                ? rect.bottom + window.scrollY + 115\r\n                : rect.top + window.scrollY - 60,\r\n            left: viewportWidth / 2 + 5,\r\n          })\r\n        }\r\n      }\r\n\r\n      rendition.on('selected', handleSelection)\r\n\r\n      rendition.themes.default({\r\n        '::selection': {\r\n          background: 'rgba(0, 0, 255, 0.1)', // Light blue on selection\r\n          color: 'inherit',\r\n        },\r\n        'a:link': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n        },\r\n        'a:hover': {\r\n          color: 'inherit !important',\r\n          '-webkit-text-fill-color': 'inherit !important',\r\n        },\r\n      })\r\n\r\n      rendition.on('rendered', section => {\r\n        section.document.addEventListener('click', () => {\r\n          const highlightElements =\r\n            section.document.querySelectorAll('.highlight')\r\n          highlightElements.forEach(el => {\r\n            el.style.transition = 'background-color 0.3s ease'\r\n          })\r\n        })\r\n      })\r\n\r\n      return () => {\r\n        rendition.off('selected', handleSelection)\r\n      }\r\n    }\r\n  }, [rendition])\r\n  useEffect(() => {\r\n    if (rendition) {\r\n      const applyHighlights = () => {\r\n        rendition.views().forEach(view => {\r\n          selections.forEach(note => {\r\n            try {\r\n              const cfiRange = new ePub.CFI(note.cfiRange)\r\n              const range = cfiRange.toRange(view.document)\r\n\r\n              if (range) {\r\n                const newHighlight = view.document.createElement('div')\r\n                newHighlight.setAttribute(\r\n                  'style',\r\n                  `\r\n                background-color: ${note.color};\r\n                opacity: 0.3;\r\n                position: absolute;\r\n                z-index: -1;\r\n                pointer-events: none;\r\n                `,\r\n                )\r\n\r\n                const rects = range.getClientRects()\r\n                for (let i = 0; i < rects.length; i++) {\r\n                  const rect = rects[i]\r\n                  const highlightClone = newHighlight.cloneNode()\r\n                  highlightClone.style.left = `${rect.left}px`\r\n                  highlightClone.style.top = `${rect.top}px`\r\n                  highlightClone.style.height = `${rect.height}px`\r\n                  highlightClone.style.width = `${rect.width}px`\r\n                  view.document.body.appendChild(highlightClone)\r\n                }\r\n              }\r\n            } catch (error) {\r\n              console.error('Error applying highlight:', error)\r\n            }\r\n          })\r\n        })\r\n      }\r\n\r\n      rendition.on('rendered', section => {\r\n        applyHighlights()\r\n      })\r\n\r\n      rendition.on('relocated', location => {\r\n        applyHighlights()\r\n      })\r\n    }\r\n  }, [rendition, selections])\r\n\r\n  const handleSave = async () => {\r\n    if (comment && selectedCfiRange) {\r\n      const newNote = {\r\n        userId: user.userId,\r\n        bookId: bookId,\r\n        content: comment,\r\n        selectedText: selectedText,\r\n        cfiRange: selectedCfiRange,\r\n        color: highlightColor,\r\n      }\r\n\r\n      try {\r\n        const response = await axios.post(\r\n          'http://localhost:8080/api/v1/note',\r\n          newNote,\r\n          {\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n            },\r\n          },\r\n        )\r\n\r\n        const createdNote = response.data\r\n\r\n        setSelections(prev => [...prev, createdNote])\r\n        setIsNote(!isNote)\r\n\r\n        rendition.annotations.add(\r\n          'highlight',\r\n          selectedCfiRange,\r\n          {},\r\n          null,\r\n          'hl',\r\n          {\r\n            fill: highlightColor,\r\n            'fill-opacity': '0.3',\r\n            'mix-blend-mode': 'multiply',\r\n          },\r\n        )\r\n\r\n        rendition.views().forEach(view => {\r\n          const highlights = view.document.querySelectorAll(\r\n            'mark[data-epubjs-annotation=\"highlight\"]',\r\n          )\r\n          highlights.forEach(highlight => {\r\n            if (highlight.dataset.epubcfi === selectedCfiRange) {\r\n              highlight.style.backgroundColor = highlightColor\r\n              highlight.style.opacity = '0.3'\r\n            }\r\n          })\r\n        })\r\n\r\n        setPopoverAnchor(null)\r\n        setComment('')\r\n        setSelectedText('')\r\n        setSelectedCfiRange('')\r\n      } catch (error) {\r\n        console.error('Error creating note:', error)\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleRemoveHighlight = async (cfiRange, noteId) => {\r\n    try {\r\n      await axios.delete(`http://localhost:8080/api/v1/note/${noteId}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      })\r\n      setSelections(selections.filter(s => s.cfiRange !== cfiRange))\r\n      rendition.annotations.remove(cfiRange)\r\n    } catch (error) {\r\n      console.error('Error deleting note:', error)\r\n    }\r\n  }\r\n\r\n  const filteredSelections = Array.isArray(selections)\r\n    ? selections\r\n        .filter(selection => {\r\n          const isTextMatch =\r\n            (selection.selectedText\r\n              ?.toLowerCase()\r\n              .includes(searchTerm.toLowerCase()) ??\r\n              false) ||\r\n            (selection.content\r\n              ?.toLowerCase()\r\n              .includes(searchTerm.toLowerCase()) ??\r\n              false)\r\n          const isColorMatch = filter === 'all' || selection.color === filter\r\n          return isTextMatch && isColorMatch\r\n        })\r\n        .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)) // Sắp xếp theo thời gian, mới nhất trước\r\n    : []\r\n\r\n  const readerStyles = {\r\n    ...ReactReaderStyle,\r\n    readerArea: {\r\n      ...ReactReaderStyle.readerArea,\r\n      backgroundColor: settings.theme,\r\n      color: settings.theme === '#121212' ? '#FFFFFF' : '#000000',\r\n    },\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className='App'\r\n      style={{height: '100vh', display: 'flex', flexDirection: 'column'}}>\r\n      <ReaderHeader\r\n        title={bookTitle}\r\n        onBack={() => navigate(-1)}\r\n        onToggleNotes={handleToggleDrawer}\r\n        onToggleSettings={handleSettingsDrawerToggle}\r\n        user={user}\r\n      />\r\n      {loading && <p>Loading...</p>}\r\n      {error && <p style={{color: 'red'}}>{error}</p>}\r\n      <ReaderContent\r\n        epubUrl={epubUrl}\r\n        location={loca}\r\n        onLocationChanged={loc => setLocation(loc)}\r\n        onGetRendition={_rendition => {\r\n          setRendition(_rendition)\r\n          _rendition.on('started', () => setLoading(false))\r\n        }}\r\n        onError={handleError}\r\n        readerStyles={readerStyles}\r\n      />\r\n      <NotePopover\r\n        anchorPosition={popoverAnchor}\r\n        open={Boolean(popoverAnchor)}\r\n        onClose={() => setPopoverAnchor(null)}\r\n        colors={colors}\r\n        highlightColor={highlightColor}\r\n        setHighlightColor={setHighlightColor}\r\n        comment={comment}\r\n        setComment={setComment}\r\n        onSave={handleSave}\r\n      />\r\n      <NotesDrawer\r\n        open={drawerOpen}\r\n        onClose={handleToggleDrawer}\r\n        searchTerm={searchTerm}\r\n        setSearchTerm={setSearchTerm}\r\n        filter={filter}\r\n        setFilter={setFilter}\r\n        colors={colors}\r\n        filteredSelections={filteredSelections}\r\n        rendition={rendition}\r\n        onRemoveHighlight={handleRemoveHighlight}\r\n        onEditNote={handleEditNote}\r\n        bookmarks={bookmarks}\r\n        onToggleBookmark={handleToggleBookmark}\r\n      />\r\n\r\n      <Dialog open={Boolean(editingNote)} onClose={() => setEditingNote(null)}>\r\n        <DialogTitle>Edit Note</DialogTitle>\r\n        <DialogContent>\r\n          <TextField\r\n            autoFocus\r\n            margin='dense'\r\n            label='Comment'\r\n            fullWidth\r\n            multiline\r\n            rows={4}\r\n            value={editingNote?.content || ''}\r\n            onChange={e =>\r\n              setEditingNote({...editingNote, content: e.target.value})\r\n            }\r\n          />\r\n          <Select\r\n            value={editingNote?.color || colors[0]}\r\n            onChange={e =>\r\n              setEditingNote({...editingNote, color: e.target.value})\r\n            }\r\n            fullWidth\r\n            style={{marginTop: '10px'}}>\r\n            {colors.map((color, index) => (\r\n              <MenuItem key={index} value={color}>\r\n                <span\r\n                  style={{\r\n                    backgroundColor: color,\r\n                    padding: '2px 10px',\r\n                    borderRadius: '5px',\r\n                    color: color,\r\n                  }}>\r\n                  {`ColorColorColorColorColorColori`}\r\n                </span>\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setEditingNote(null)}>Cancel</Button>\r\n          <Button onClick={handleSaveEdit}>Save</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <SettingsDrawer\r\n        open={settingsDrawerOpen}\r\n        onClose={handleSettingsDrawerToggle}\r\n        settings={settings}\r\n        updateSettings={updateSettings}\r\n        themes={themes}\r\n        fontFamilies={fontFamilies}\r\n        onResetSettings={handleResetSettings}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ReadBookScreen\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}